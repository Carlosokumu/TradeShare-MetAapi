'use strict';

var _should = require('should');

var _should2 = _interopRequireDefault(_should);

var _sinon = require('sinon');

var _sinon2 = _interopRequireDefault(_sinon);

var _metatraderAccountGeneratorApi = require('./metatraderAccountGeneratorApi');

var _metatraderAccountGeneratorApi2 = _interopRequireDefault(_metatraderAccountGeneratorApi);

var _metatraderAccountCredentials = require('./metatraderAccountCredentials');

var _metatraderAccountCredentials2 = _interopRequireDefault(_metatraderAccountCredentials);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * @test {MetatraderAccountGeneratorApi}
 * @test {MetatraderAccountCredentials}
 */
describe('MetatraderAccountGeneratorApi', () => {

  let sandbox;
  let api;
  let client = {
    createMT4DemoAccount: () => {},
    createMT5DemoAccount: () => {},
    createMT4LiveAccount: () => {},
    createMT5LiveAccount: () => {}
  };

  before(() => {
    api = new _metatraderAccountGeneratorApi2.default(client);
    sandbox = _sinon2.default.createSandbox();
  });

  afterEach(() => {
    sandbox.restore();
  });

  /**
   * @test {MetatraderAccountGeneratorApi#createMT4DemoAccount}
   */
  it('should create MT4 demo account', async () => {
    sandbox.stub(client, 'createMT4DemoAccount').resolves({
      login: '12345',
      password: 'qwerty',
      serverName: 'HugosWay-Demo3',
      investorPassword: 'qwerty'
    });
    let newAccountData = {
      accountType: 'type',
      balance: 10,
      email: 'test@test.com',
      leverage: 15,
      serverName: 'HugosWay-Demo3'
    };
    let account = await api.createMT4DemoAccount(newAccountData, 'profileId1');
    account.should.match({ login: '12345', password: 'qwerty', serverName: 'HugosWay-Demo3',
      investorPassword: 'qwerty' });
    (account instanceof _metatraderAccountCredentials2.default).should.be.true();
    _sinon2.default.assert.calledWith(client.createMT4DemoAccount, newAccountData, 'profileId1');
  });

  /**
   * @test {MetatraderAccountGeneratorApi#createMT4LiveAccount}
   */
  it('should create MT4 live account', async () => {
    sandbox.stub(client, 'createMT4LiveAccount').resolves({
      login: '12345',
      password: 'qwerty',
      serverName: 'HugosWay-Live3',
      investorPassword: 'qwerty'
    });
    let newAccountData = {
      accountType: 'type',
      balance: 10,
      email: 'test@test.com',
      leverage: 15,
      serverName: 'HugosWay-Live3'
    };
    let account = await api.createMT4LiveAccount(newAccountData, 'profileId1');
    account.should.match({ login: '12345', password: 'qwerty', serverName: 'HugosWay-Live3',
      investorPassword: 'qwerty' });
    (account instanceof _metatraderAccountCredentials2.default).should.be.true();
    _sinon2.default.assert.calledWith(client.createMT4LiveAccount, newAccountData, 'profileId1');
  });

  /**
   * @test {MetatraderAccountGeneratorApi#createMT5DemoAccount}
   */
  it('should create MT5 demo account', async () => {
    sandbox.stub(client, 'createMT5DemoAccount').resolves({
      login: '12345',
      password: 'qwerty',
      serverName: 'HugosWay-Demo3',
      investorPassword: 'qwerty'
    });
    let newAccountData = {
      accountType: 'type',
      balance: 15,
      email: 'test@test.com',
      leverage: 20,
      serverName: 'HugosWay-Demo3'
    };
    let account = await api.createMT5DemoAccount(newAccountData, 'profileId2');
    account.should.match({ login: '12345', password: 'qwerty', serverName: 'HugosWay-Demo3',
      investorPassword: 'qwerty' });
    (account instanceof _metatraderAccountCredentials2.default).should.be.true();
    _sinon2.default.assert.calledWith(client.createMT5DemoAccount, newAccountData, 'profileId2');
  });

  /**
   * @test {MetatraderAccountGeneratorApi#createMT5LiveAccount}
   */
  it('should create MT5 live account', async () => {
    sandbox.stub(client, 'createMT5LiveAccount').resolves({
      login: '12345',
      password: 'qwerty',
      serverName: 'HugosWay-Live3',
      investorPassword: 'qwerty'
    });
    let newAccountData = {
      accountType: 'type',
      balance: 15,
      email: 'test@test.com',
      leverage: 20,
      serverName: 'HugosWay-Live3'
    };
    let account = await api.createMT5LiveAccount(newAccountData, 'profileId2');
    account.should.match({ login: '12345', password: 'qwerty', serverName: 'HugosWay-Live3',
      investorPassword: 'qwerty' });
    (account instanceof _metatraderAccountCredentials2.default).should.be.true();
    _sinon2.default.assert.calledWith(client.createMT5LiveAccount, newAccountData, 'profileId2');
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9tZXRhQXBpL21ldGF0cmFkZXJBY2NvdW50R2VuZXJhdG9yQXBpLnNwZWMuZXM2Il0sIm5hbWVzIjpbImRlc2NyaWJlIiwic2FuZGJveCIsImFwaSIsImNsaWVudCIsImNyZWF0ZU1UNERlbW9BY2NvdW50IiwiY3JlYXRlTVQ1RGVtb0FjY291bnQiLCJjcmVhdGVNVDRMaXZlQWNjb3VudCIsImNyZWF0ZU1UNUxpdmVBY2NvdW50IiwiYmVmb3JlIiwiTWV0YXRyYWRlckFjY291bnRHZW5lcmF0b3JBcGkiLCJzaW5vbiIsImNyZWF0ZVNhbmRib3giLCJhZnRlckVhY2giLCJyZXN0b3JlIiwiaXQiLCJzdHViIiwicmVzb2x2ZXMiLCJsb2dpbiIsInBhc3N3b3JkIiwic2VydmVyTmFtZSIsImludmVzdG9yUGFzc3dvcmQiLCJuZXdBY2NvdW50RGF0YSIsImFjY291bnRUeXBlIiwiYmFsYW5jZSIsImVtYWlsIiwibGV2ZXJhZ2UiLCJhY2NvdW50Iiwic2hvdWxkIiwibWF0Y2giLCJNZXRhdHJhZGVyQWNjb3VudENyZWRlbnRpYWxzIiwiYmUiLCJ0cnVlIiwiYXNzZXJ0IiwiY2FsbGVkV2l0aCJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7OztBQUVBOzs7O0FBSUFBLFNBQVMsK0JBQVQsRUFBMEMsTUFBTTs7QUFFOUMsTUFBSUMsT0FBSjtBQUNBLE1BQUlDLEdBQUo7QUFDQSxNQUFJQyxTQUFTO0FBQ1hDLDBCQUFzQixNQUFNLENBQUUsQ0FEbkI7QUFFWEMsMEJBQXNCLE1BQU0sQ0FBRSxDQUZuQjtBQUdYQywwQkFBc0IsTUFBTSxDQUFFLENBSG5CO0FBSVhDLDBCQUFzQixNQUFNLENBQUU7QUFKbkIsR0FBYjs7QUFPQUMsU0FBTyxNQUFNO0FBQ1hOLFVBQU0sSUFBSU8sdUNBQUosQ0FBa0NOLE1BQWxDLENBQU47QUFDQUYsY0FBVVMsZ0JBQU1DLGFBQU4sRUFBVjtBQUNELEdBSEQ7O0FBS0FDLFlB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RyxFQUF6RCxDQUE0REMsSUFBNUQ7QUFDQXJCLG9CQUFNc0IsTUFBTixDQUFhQyxVQUFiLENBQXdCOUIsT0FBT0Usb0JBQS9CLEVBQXFEZ0IsY0FBckQsRUFBcUUsWUFBckU7QUFDRCxHQW5CRDs7QUFxQkE7OztBQUdBUCxLQUFHLGdDQUFILEVBQXFDLFlBQVk7QUFDL0NiLFlBQVFjLElBQVIsQ0FBYVosTUFBYixFQUFxQixzQkFBckIsRUFBNkNhLFFBQTdDLENBQXNEO0FBQ3BEQyxhQUFPLE9BRDZDO0FBRXBEQyxnQkFBVSxRQUYwQztBQUdwREMsa0JBQVksZ0JBSHdDO0FBSXBEQyx3QkFBa0I7QUFKa0MsS0FBdEQ7QUFNQSxRQUFJQyxpQkFBaUI7QUFDbkJDLG1CQUFhLE1BRE07QUFFbkJDLGVBQVMsRUFGVTtBQUduQkMsYUFBTyxlQUhZO0FBSW5CQyxnQkFBVSxFQUpTO0FBS25CTixrQkFBWTtBQUxPLEtBQXJCO0FBT0EsUUFBSU8sVUFBVSxNQUFNeEIsSUFBSUssb0JBQUosQ0FBeUJjLGNBQXpCLEVBQXlDLFlBQXpDLENBQXBCO0FBQ0FLLFlBQVFDLE1BQVIsQ0FBZUMsS0FBZixDQUFxQixFQUFDWCxPQUFPLE9BQVIsRUFBaUJDLFVBQVUsUUFBM0IsRUFBcUNDLFlBQVksZ0JBQWpEO0FBQ25CQyx3QkFBa0IsUUFEQyxFQUFyQjtBQUVBLEtBQUNNLG1CQUFtQkcsc0NBQXBCLEVBQWtERixNQUFsRCxDQUF5REcsRUFBekQsQ0FBNERDLElBQTVEO0FBQ0FyQixvQkFBTXNCLE1BQU4sQ0FBYUMsVUFBYixDQUF3QjlCLE9BQU9JLG9CQUEvQixFQUFxRGMsY0FBckQsRUFBcUUsWUFBckU7QUFDRCxHQW5CRDtBQXFCRCxDQXBIRCIsImZpbGUiOiJtZXRhdHJhZGVyQWNjb3VudEdlbmVyYXRvckFwaS5zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgc2hvdWxkIGZyb20gJ3Nob3VsZCc7XG5pbXBvcnQgc2lub24gZnJvbSAnc2lub24nO1xuaW1wb3J0IE1ldGF0cmFkZXJBY2NvdW50R2VuZXJhdG9yQXBpIGZyb20gJy4vbWV0YXRyYWRlckFjY291bnRHZW5lcmF0b3JBcGknO1xuaW1wb3J0IE1ldGF0cmFkZXJBY2NvdW50Q3JlZGVudGlhbHMgZnJvbSAnLi9tZXRhdHJhZGVyQWNjb3VudENyZWRlbnRpYWxzJztcblxuLyoqXG4gKiBAdGVzdCB7TWV0YXRyYWRlckFjY291bnRHZW5lcmF0b3JBcGl9XG4gKiBAdGVzdCB7TWV0YXRyYWRlckFjY291bnRDcmVkZW50aWFsc31cbiAqL1xuZGVzY3JpYmUoJ01ldGF0cmFkZXJBY2NvdW50R2VuZXJhdG9yQXBpJywgKCkgPT4ge1xuXG4gIGxldCBzYW5kYm94O1xuICBsZXQgYXBpO1xuICBsZXQgY2xpZW50ID0ge1xuICAgIGNyZWF0ZU1UNERlbW9BY2NvdW50OiAoKSA9PiB7fSxcbiAgICBjcmVhdGVNVDVEZW1vQWNjb3VudDogKCkgPT4ge30sXG4gICAgY3JlYXRlTVQ0TGl2ZUFjY291bnQ6ICgpID0+IHt9LFxuICAgIGNyZWF0ZU1UNUxpdmVBY2NvdW50OiAoKSA9PiB7fVxuICB9O1xuXG4gIGJlZm9yZSgoKSA9PiB7XG4gICAgYXBpID0gbmV3IE1ldGF0cmFkZXJBY2NvdW50R2VuZXJhdG9yQXBpKGNsaWVudCk7XG4gICAgc2FuZGJveCA9IHNpbm9uLmNyZWF0ZVNhbmRib3goKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBzYW5kYm94LnJlc3RvcmUoKTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEB0ZXN0IHtNZXRhdHJhZGVyQWNjb3VudEdlbmVyYXRvckFwaSNjcmVhdGVNVDREZW1vQWNjb3VudH1cbiAgICovXG4gIGl0KCdzaG91bGQgY3JlYXRlIE1UNCBkZW1vIGFjY291bnQnLCBhc3luYyAoKSA9PiB7XG4gICAgc2FuZGJveC5zdHViKGNsaWVudCwgJ2NyZWF0ZU1UNERlbW9BY2NvdW50JykucmVzb2x2ZXMoe1xuICAgICAgbG9naW46ICcxMjM0NScsXG4gICAgICBwYXNzd29yZDogJ3F3ZXJ0eScsXG4gICAgICBzZXJ2ZXJOYW1lOiAnSHVnb3NXYXktRGVtbzMnLFxuICAgICAgaW52ZXN0b3JQYXNzd29yZDogJ3F3ZXJ0eSdcbiAgICB9KTtcbiAgICBsZXQgbmV3QWNjb3VudERhdGEgPSB7XG4gICAgICBhY2NvdW50VHlwZTogJ3R5cGUnLFxuICAgICAgYmFsYW5jZTogMTAsXG4gICAgICBlbWFpbDogJ3Rlc3RAdGVzdC5jb20nLFxuICAgICAgbGV2ZXJhZ2U6IDE1LFxuICAgICAgc2VydmVyTmFtZTogJ0h1Z29zV2F5LURlbW8zJ1xuICAgIH07XG4gICAgbGV0IGFjY291bnQgPSBhd2FpdCBhcGkuY3JlYXRlTVQ0RGVtb0FjY291bnQobmV3QWNjb3VudERhdGEsICdwcm9maWxlSWQxJyk7XG4gICAgYWNjb3VudC5zaG91bGQubWF0Y2goe2xvZ2luOiAnMTIzNDUnLCBwYXNzd29yZDogJ3F3ZXJ0eScsIHNlcnZlck5hbWU6ICdIdWdvc1dheS1EZW1vMycsXG4gICAgICBpbnZlc3RvclBhc3N3b3JkOiAncXdlcnR5J30pO1xuICAgIChhY2NvdW50IGluc3RhbmNlb2YgTWV0YXRyYWRlckFjY291bnRDcmVkZW50aWFscykuc2hvdWxkLmJlLnRydWUoKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aChjbGllbnQuY3JlYXRlTVQ0RGVtb0FjY291bnQsIG5ld0FjY291bnREYXRhLCAncHJvZmlsZUlkMScpO1xuICB9KTtcblxuICAvKipcbiAgICogQHRlc3Qge01ldGF0cmFkZXJBY2NvdW50R2VuZXJhdG9yQXBpI2NyZWF0ZU1UNExpdmVBY2NvdW50fVxuICAgKi9cbiAgaXQoJ3Nob3VsZCBjcmVhdGUgTVQ0IGxpdmUgYWNjb3VudCcsIGFzeW5jICgpID0+IHtcbiAgICBzYW5kYm94LnN0dWIoY2xpZW50LCAnY3JlYXRlTVQ0TGl2ZUFjY291bnQnKS5yZXNvbHZlcyh7XG4gICAgICBsb2dpbjogJzEyMzQ1JyxcbiAgICAgIHBhc3N3b3JkOiAncXdlcnR5JyxcbiAgICAgIHNlcnZlck5hbWU6ICdIdWdvc1dheS1MaXZlMycsXG4gICAgICBpbnZlc3RvclBhc3N3b3JkOiAncXdlcnR5J1xuICAgIH0pO1xuICAgIGxldCBuZXdBY2NvdW50RGF0YSA9IHtcbiAgICAgIGFjY291bnRUeXBlOiAndHlwZScsXG4gICAgICBiYWxhbmNlOiAxMCxcbiAgICAgIGVtYWlsOiAndGVzdEB0ZXN0LmNvbScsXG4gICAgICBsZXZlcmFnZTogMTUsXG4gICAgICBzZXJ2ZXJOYW1lOiAnSHVnb3NXYXktTGl2ZTMnXG4gICAgfTtcbiAgICBsZXQgYWNjb3VudCA9IGF3YWl0IGFwaS5jcmVhdGVNVDRMaXZlQWNjb3VudChuZXdBY2NvdW50RGF0YSwgJ3Byb2ZpbGVJZDEnKTtcbiAgICBhY2NvdW50LnNob3VsZC5tYXRjaCh7bG9naW46ICcxMjM0NScsIHBhc3N3b3JkOiAncXdlcnR5Jywgc2VydmVyTmFtZTogJ0h1Z29zV2F5LUxpdmUzJyxcbiAgICAgIGludmVzdG9yUGFzc3dvcmQ6ICdxd2VydHknfSk7XG4gICAgKGFjY291bnQgaW5zdGFuY2VvZiBNZXRhdHJhZGVyQWNjb3VudENyZWRlbnRpYWxzKS5zaG91bGQuYmUudHJ1ZSgpO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKGNsaWVudC5jcmVhdGVNVDRMaXZlQWNjb3VudCwgbmV3QWNjb3VudERhdGEsICdwcm9maWxlSWQxJyk7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAdGVzdCB7TWV0YXRyYWRlckFjY291bnRHZW5lcmF0b3JBcGkjY3JlYXRlTVQ1RGVtb0FjY291bnR9XG4gICAqL1xuICBpdCgnc2hvdWxkIGNyZWF0ZSBNVDUgZGVtbyBhY2NvdW50JywgYXN5bmMgKCkgPT4ge1xuICAgIHNhbmRib3guc3R1YihjbGllbnQsICdjcmVhdGVNVDVEZW1vQWNjb3VudCcpLnJlc29sdmVzKHtcbiAgICAgIGxvZ2luOiAnMTIzNDUnLFxuICAgICAgcGFzc3dvcmQ6ICdxd2VydHknLFxuICAgICAgc2VydmVyTmFtZTogJ0h1Z29zV2F5LURlbW8zJyxcbiAgICAgIGludmVzdG9yUGFzc3dvcmQ6ICdxd2VydHknXG4gICAgfSk7XG4gICAgbGV0IG5ld0FjY291bnREYXRhID0ge1xuICAgICAgYWNjb3VudFR5cGU6ICd0eXBlJyxcbiAgICAgIGJhbGFuY2U6IDE1LFxuICAgICAgZW1haWw6ICd0ZXN0QHRlc3QuY29tJyxcbiAgICAgIGxldmVyYWdlOiAyMCxcbiAgICAgIHNlcnZlck5hbWU6ICdIdWdvc1dheS1EZW1vMydcbiAgICB9O1xuICAgIGxldCBhY2NvdW50ID0gYXdhaXQgYXBpLmNyZWF0ZU1UNURlbW9BY2NvdW50KG5ld0FjY291bnREYXRhLCAncHJvZmlsZUlkMicpO1xuICAgIGFjY291bnQuc2hvdWxkLm1hdGNoKHtsb2dpbjogJzEyMzQ1JywgcGFzc3dvcmQ6ICdxd2VydHknLCBzZXJ2ZXJOYW1lOiAnSHVnb3NXYXktRGVtbzMnLCBcbiAgICAgIGludmVzdG9yUGFzc3dvcmQ6ICdxd2VydHknfSk7XG4gICAgKGFjY291bnQgaW5zdGFuY2VvZiBNZXRhdHJhZGVyQWNjb3VudENyZWRlbnRpYWxzKS5zaG91bGQuYmUudHJ1ZSgpO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKGNsaWVudC5jcmVhdGVNVDVEZW1vQWNjb3VudCwgbmV3QWNjb3VudERhdGEsICdwcm9maWxlSWQyJyk7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAdGVzdCB7TWV0YXRyYWRlckFjY291bnRHZW5lcmF0b3JBcGkjY3JlYXRlTVQ1TGl2ZUFjY291bnR9XG4gICAqL1xuICBpdCgnc2hvdWxkIGNyZWF0ZSBNVDUgbGl2ZSBhY2NvdW50JywgYXN5bmMgKCkgPT4ge1xuICAgIHNhbmRib3guc3R1YihjbGllbnQsICdjcmVhdGVNVDVMaXZlQWNjb3VudCcpLnJlc29sdmVzKHtcbiAgICAgIGxvZ2luOiAnMTIzNDUnLFxuICAgICAgcGFzc3dvcmQ6ICdxd2VydHknLFxuICAgICAgc2VydmVyTmFtZTogJ0h1Z29zV2F5LUxpdmUzJyxcbiAgICAgIGludmVzdG9yUGFzc3dvcmQ6ICdxd2VydHknXG4gICAgfSk7XG4gICAgbGV0IG5ld0FjY291bnREYXRhID0ge1xuICAgICAgYWNjb3VudFR5cGU6ICd0eXBlJyxcbiAgICAgIGJhbGFuY2U6IDE1LFxuICAgICAgZW1haWw6ICd0ZXN0QHRlc3QuY29tJyxcbiAgICAgIGxldmVyYWdlOiAyMCxcbiAgICAgIHNlcnZlck5hbWU6ICdIdWdvc1dheS1MaXZlMydcbiAgICB9O1xuICAgIGxldCBhY2NvdW50ID0gYXdhaXQgYXBpLmNyZWF0ZU1UNUxpdmVBY2NvdW50KG5ld0FjY291bnREYXRhLCAncHJvZmlsZUlkMicpO1xuICAgIGFjY291bnQuc2hvdWxkLm1hdGNoKHtsb2dpbjogJzEyMzQ1JywgcGFzc3dvcmQ6ICdxd2VydHknLCBzZXJ2ZXJOYW1lOiAnSHVnb3NXYXktTGl2ZTMnLFxuICAgICAgaW52ZXN0b3JQYXNzd29yZDogJ3F3ZXJ0eSd9KTtcbiAgICAoYWNjb3VudCBpbnN0YW5jZW9mIE1ldGF0cmFkZXJBY2NvdW50Q3JlZGVudGlhbHMpLnNob3VsZC5iZS50cnVlKCk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgoY2xpZW50LmNyZWF0ZU1UNUxpdmVBY2NvdW50LCBuZXdBY2NvdW50RGF0YSwgJ3Byb2ZpbGVJZDInKTtcbiAgfSk7XG5cbn0pO1xuIl19