'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _metaApi = require('../metaApi.client');

var _metaApi2 = _interopRequireDefault(_metaApi);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * metaapi.cloud MetaTrader account generator API client
 */
class MetatraderAccountGeneratorClient extends _metaApi2.default {

  /**
   * New MetaTrader 4 demo account request model
   * @typedef {Object} NewMT4DemoAccount
   * @property {string} accountType account type. Available account type values can be found in mobile MT application or
   * in MT terminal downloaded from our broker
   * @property {number} balance account balance
   * @property {string} email account holder's email
   * @property {number} leverage account leverage
   * @property {string} name account holder's name
   * @property {string} phone account holder's phone, in international format
   * @property {string} serverName server name
   */

  /**
   * New MetaTrader 4 live account request model
   * @typedef {Object} NewMT4LiveAccount
   * @property {string} accountType account type. Available account type values can be found in mobile MT application or
   * in MT terminal downloaded from our broker
   * @property {string} address account holder's address
   * @property {string} city account holder's city
   * @property {string} country account holder's country
   * @property {string} email account holder's email
   * @property {number} leverage account leverage
   * @property {string} name account holder's name
   * @property {string} phone account holder's phone, in international format
   * @property {string} serverName server name
   * @property {string} state account holder's state
   * @property {string} zip zip address
   */

  /**
   * New MetaTrader 5 demo account request model
   * @typedef {Object} NewMT5DemoAccount
   * @property {string} accountType account type. Available account type values can be found in mobile MT application or
   * in MT terminal downloaded from our broker
   * @property {number} balance account balance
   * @property {string} email account holder's email
   * @property {number} leverage account leverage
   * @property {string} name account holder's name
   * @property {string} phone account holder's phone, in international format
   * @property {string} serverName server name
   */

  /**
   * New MetaTrader 5 live account request model
   * @typedef {Object} NewMT5LiveAccount
   * @property {string} accountType account type. Available account type values can be found in mobile MT application or
   * in MT terminal downloaded from our broker
   * @property {string} address account holder's address
   * @property {string} city account holder's city
   * @property {string} country account holder's country
   * @property {string} email account holder's email
   * @property {number} leverage account leverage
   * @property {string} name account holder's name
   * @property {string} phone account holder's phone, in international format
   * @property {string} serverName server name
   * @property {string} state account holder's state
   * @property {string} zip zip address
   */

  /**
   * MetaTrader account credetials model
   * @typedef {Object} MetatraderAccountCredentialsDto
   * @property {String} login account login
   * @property {String} password account password
   * @property {String} serverName MetaTrader server name
   * @property {String} investorPassword account investor (read-only) password
   */

  /**
   * Creates new MetaTrader 4 demo account
   * See https://metaapi.cloud/docs/provisioning/api/generateAccount/createMT4DemoAccount/
   * Method is accessible only with API access token
   * @param {NewMT4DemoAccount} account account to create
   * @param {string} [profileId] id of the provisioning profile that will be used as the basis for creating this account
   * @return {Promise<MetatraderAccountCredentialsDto>} promise resolving with MetaTrader account credetials
   */
  createMT4DemoAccount(account, profileId) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('createMT4DemoAccount');
    }
    const opts = {
      url: `${this._host}/users/current/provisioning-profiles/${profileId || 'default'}/mt4-demo-accounts`,
      method: 'POST',
      headers: {
        'auth-token': this._token
      },
      json: true,
      body: account
    };
    return this._httpClient.request(opts, 'createMT4DemoAccount');
  }

  /**
   * Creates new MetaTrader 4 live account
   * See https://metaapi.cloud/docs/provisioning/api/generateAccount/createMT4LiveAccount/
   * Method is accessible only with API access token
   * @param {NewMT4LiveAccount} account account to create
   * @param {string} [profileId] id of the provisioning profile that will be used as the basis for creating this account
   * @return {Promise<MetatraderAccountCredentialsDto>} promise resolving with MetaTrader account credetials
   */
  createMT4LiveAccount(account, profileId) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('createMT4LiveAccount');
    }
    const opts = {
      url: `${this._host}/users/current/provisioning-profiles/${profileId || 'default'}/mt4-live-accounts`,
      method: 'POST',
      headers: {
        'auth-token': this._token
      },
      json: true,
      body: account
    };
    return this._httpClient.request(opts, 'createMT4LiveAccount');
  }

  /**
   * Creates new MetaTrader 5 demo account.
   * See https://metaapi.cloud/docs/provisioning/api/generateAccount/createMT5DemoAccount/
   * Method is accessible only with API access token
   * @param {NewMT5DemoAccount} account account to create
   * @param {string} [profileId] id of the provisioning profile that will be used as the basis for creating this account
   * @return {Promise<MetatraderAccountCredentialsDto>} promise resolving with MetaTrader account credentials
   */
  createMT5DemoAccount(account, profileId) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('createMT5DemoAccount');
    }
    const opts = {
      url: `${this._host}/users/current/provisioning-profiles/${profileId || 'default'}/mt5-demo-accounts`,
      method: 'POST',
      headers: {
        'auth-token': this._token
      },
      json: true,
      body: account
    };
    return this._httpClient.request(opts, 'createMT5DemoAccount');
  }

  /**
   * Creates new MetaTrader 5 live account.
   * See https://metaapi.cloud/docs/provisioning/api/generateAccount/createMT5LiveAccount/
   * Method is accessible only with API access token
   * @param {NewMT5LiveAccount} account account to create
   * @param {string} [profileId] id of the provisioning profile that will be used as the basis for creating this account
   * @return {Promise<MetatraderAccountCredentialsDto>} promise resolving with MetaTrader account credentials
   */
  createMT5LiveAccount(account, profileId) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('createMT5LiveAccount');
    }
    const opts = {
      url: `${this._host}/users/current/provisioning-profiles/${profileId || 'default'}/mt5-live-accounts`,
      method: 'POST',
      headers: {
        'auth-token': this._token
      },
      json: true,
      body: account
    };
    return this._httpClient.request(opts, 'createMT5LiveAccount');
  }

}
exports.default = MetatraderAccountGeneratorClient;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9jbGllbnRzL21ldGFBcGkvbWV0YXRyYWRlckFjY291bnRHZW5lcmF0b3IuY2xpZW50LmVzNiJdLCJuYW1lcyI6WyJNZXRhdHJhZGVyQWNjb3VudEdlbmVyYXRvckNsaWVudCIsIk1ldGFBcGlDbGllbnQiLCJjcmVhdGVNVDREZW1vQWNjb3VudCIsImFjY291bnQiLCJwcm9maWxlSWQiLCJfaXNOb3RKd3RUb2tlbiIsIl9oYW5kbGVOb0FjY2Vzc0Vycm9yIiwib3B0cyIsInVybCIsIl9ob3N0IiwibWV0aG9kIiwiaGVhZGVycyIsIl90b2tlbiIsImpzb24iLCJib2R5IiwiX2h0dHBDbGllbnQiLCJyZXF1ZXN0IiwiY3JlYXRlTVQ0TGl2ZUFjY291bnQiLCJjcmVhdGVNVDVEZW1vQWNjb3VudCIsImNyZWF0ZU1UNUxpdmVBY2NvdW50Il0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7O0FBRUE7Ozs7OztBQUVBOzs7QUFHZSxNQUFNQSxnQ0FBTixTQUErQ0MsaUJBQS9DLENBQTZEOztBQUUxRTs7Ozs7Ozs7Ozs7OztBQWFBOzs7Ozs7Ozs7Ozs7Ozs7OztBQWlCQTs7Ozs7Ozs7Ozs7OztBQWFBOzs7Ozs7Ozs7Ozs7Ozs7OztBQWlCQTs7Ozs7Ozs7O0FBU0E7Ozs7Ozs7O0FBUUFDLHVCQUFxQkMsT0FBckIsRUFBOEJDLFNBQTlCLEVBQXlDO0FBQ3ZDLFFBQUksS0FBS0MsY0FBTCxFQUFKLEVBQTJCO0FBQ3pCLGFBQU8sS0FBS0Msb0JBQUwsQ0FBMEIsc0JBQTFCLENBQVA7QUFDRDtBQUNELFVBQU1DLE9BQU87QUFDWEMsV0FBTSxHQUFFLEtBQUtDLEtBQU0sd0NBQXVDTCxhQUFhLFNBQVUsb0JBRHRFO0FBRVhNLGNBQVEsTUFGRztBQUdYQyxlQUFTO0FBQ1Asc0JBQWMsS0FBS0M7QUFEWixPQUhFO0FBTVhDLFlBQU0sSUFOSztBQU9YQyxZQUFNWDtBQVBLLEtBQWI7QUFTQSxXQUFPLEtBQUtZLFdBQUwsQ0FBaUJDLE9BQWpCLENBQXlCVCxJQUF6QixFQUErQixzQkFBL0IsQ0FBUDtBQUNEOztBQUVEOzs7Ozs7OztBQVFBVSx1QkFBcUJkLE9BQXJCLEVBQThCQyxTQUE5QixFQUF5QztBQUN2QyxRQUFJLEtBQUtDLGNBQUwsRUFBSixFQUEyQjtBQUN6QixhQUFPLEtBQUtDLG9CQUFMLENBQTBCLHNCQUExQixDQUFQO0FBQ0Q7QUFDRCxVQUFNQyxPQUFPO0FBQ1hDLFdBQU0sR0FBRSxLQUFLQyxLQUFNLHdDQUF1Q0wsYUFBYSxTQUFVLG9CQUR0RTtBQUVYTSxjQUFRLE1BRkc7QUFHWEMsZUFBUztBQUNQLHNCQUFjLEtBQUtDO0FBRFosT0FIRTtBQU1YQyxZQUFNLElBTks7QUFPWEMsWUFBTVg7QUFQSyxLQUFiO0FBU0EsV0FBTyxLQUFLWSxXQUFMLENBQWlCQyxPQUFqQixDQUF5QlQsSUFBekIsRUFBK0Isc0JBQS9CLENBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7QUFRQVcsdUJBQXFCZixPQUFyQixFQUE4QkMsU0FBOUIsRUFBeUM7QUFDdkMsUUFBSSxLQUFLQyxjQUFMLEVBQUosRUFBMkI7QUFDekIsYUFBTyxLQUFLQyxvQkFBTCxDQUEwQixzQkFBMUIsQ0FBUDtBQUNEO0FBQ0QsVUFBTUMsT0FBTztBQUNYQyxXQUFNLEdBQUUsS0FBS0MsS0FBTSx3Q0FBdUNMLGFBQWEsU0FBVSxvQkFEdEU7QUFFWE0sY0FBUSxNQUZHO0FBR1hDLGVBQVM7QUFDUCxzQkFBYyxLQUFLQztBQURaLE9BSEU7QUFNWEMsWUFBTSxJQU5LO0FBT1hDLFlBQU1YO0FBUEssS0FBYjtBQVNBLFdBQU8sS0FBS1ksV0FBTCxDQUFpQkMsT0FBakIsQ0FBeUJULElBQXpCLEVBQStCLHNCQUEvQixDQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUUFZLHVCQUFxQmhCLE9BQXJCLEVBQThCQyxTQUE5QixFQUF5QztBQUN2QyxRQUFJLEtBQUtDLGNBQUwsRUFBSixFQUEyQjtBQUN6QixhQUFPLEtBQUtDLG9CQUFMLENBQTBCLHNCQUExQixDQUFQO0FBQ0Q7QUFDRCxVQUFNQyxPQUFPO0FBQ1hDLFdBQU0sR0FBRSxLQUFLQyxLQUFNLHdDQUF1Q0wsYUFBYSxTQUFVLG9CQUR0RTtBQUVYTSxjQUFRLE1BRkc7QUFHWEMsZUFBUztBQUNQLHNCQUFjLEtBQUtDO0FBRFosT0FIRTtBQU1YQyxZQUFNLElBTks7QUFPWEMsWUFBTVg7QUFQSyxLQUFiO0FBU0EsV0FBTyxLQUFLWSxXQUFMLENBQWlCQyxPQUFqQixDQUF5QlQsSUFBekIsRUFBK0Isc0JBQS9CLENBQVA7QUFDRDs7QUFyS3lFO2tCQUF2RFAsZ0MiLCJmaWxlIjoibWV0YXRyYWRlckFjY291bnRHZW5lcmF0b3IuY2xpZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgTWV0YUFwaUNsaWVudCBmcm9tICcuLi9tZXRhQXBpLmNsaWVudCc7XG5cbi8qKlxuICogbWV0YWFwaS5jbG91ZCBNZXRhVHJhZGVyIGFjY291bnQgZ2VuZXJhdG9yIEFQSSBjbGllbnRcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWV0YXRyYWRlckFjY291bnRHZW5lcmF0b3JDbGllbnQgZXh0ZW5kcyBNZXRhQXBpQ2xpZW50IHtcblxuICAvKipcbiAgICogTmV3IE1ldGFUcmFkZXIgNCBkZW1vIGFjY291bnQgcmVxdWVzdCBtb2RlbFxuICAgKiBAdHlwZWRlZiB7T2JqZWN0fSBOZXdNVDREZW1vQWNjb3VudFxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gYWNjb3VudFR5cGUgYWNjb3VudCB0eXBlLiBBdmFpbGFibGUgYWNjb3VudCB0eXBlIHZhbHVlcyBjYW4gYmUgZm91bmQgaW4gbW9iaWxlIE1UIGFwcGxpY2F0aW9uIG9yXG4gICAqIGluIE1UIHRlcm1pbmFsIGRvd25sb2FkZWQgZnJvbSBvdXIgYnJva2VyXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBiYWxhbmNlIGFjY291bnQgYmFsYW5jZVxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gZW1haWwgYWNjb3VudCBob2xkZXIncyBlbWFpbFxuICAgKiBAcHJvcGVydHkge251bWJlcn0gbGV2ZXJhZ2UgYWNjb3VudCBsZXZlcmFnZVxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSBhY2NvdW50IGhvbGRlcidzIG5hbWVcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IHBob25lIGFjY291bnQgaG9sZGVyJ3MgcGhvbmUsIGluIGludGVybmF0aW9uYWwgZm9ybWF0XG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzZXJ2ZXJOYW1lIHNlcnZlciBuYW1lXG4gICAqL1xuXG4gIC8qKlxuICAgKiBOZXcgTWV0YVRyYWRlciA0IGxpdmUgYWNjb3VudCByZXF1ZXN0IG1vZGVsXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IE5ld01UNExpdmVBY2NvdW50XG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBhY2NvdW50VHlwZSBhY2NvdW50IHR5cGUuIEF2YWlsYWJsZSBhY2NvdW50IHR5cGUgdmFsdWVzIGNhbiBiZSBmb3VuZCBpbiBtb2JpbGUgTVQgYXBwbGljYXRpb24gb3JcbiAgICogaW4gTVQgdGVybWluYWwgZG93bmxvYWRlZCBmcm9tIG91ciBicm9rZXJcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IGFkZHJlc3MgYWNjb3VudCBob2xkZXIncyBhZGRyZXNzXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBjaXR5IGFjY291bnQgaG9sZGVyJ3MgY2l0eVxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gY291bnRyeSBhY2NvdW50IGhvbGRlcidzIGNvdW50cnlcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IGVtYWlsIGFjY291bnQgaG9sZGVyJ3MgZW1haWxcbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IGxldmVyYWdlIGFjY291bnQgbGV2ZXJhZ2VcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IG5hbWUgYWNjb3VudCBob2xkZXIncyBuYW1lXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBwaG9uZSBhY2NvdW50IGhvbGRlcidzIHBob25lLCBpbiBpbnRlcm5hdGlvbmFsIGZvcm1hdFxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gc2VydmVyTmFtZSBzZXJ2ZXIgbmFtZVxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gc3RhdGUgYWNjb3VudCBob2xkZXIncyBzdGF0ZVxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gemlwIHppcCBhZGRyZXNzXG4gICAqL1xuXG4gIC8qKlxuICAgKiBOZXcgTWV0YVRyYWRlciA1IGRlbW8gYWNjb3VudCByZXF1ZXN0IG1vZGVsXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IE5ld01UNURlbW9BY2NvdW50XG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBhY2NvdW50VHlwZSBhY2NvdW50IHR5cGUuIEF2YWlsYWJsZSBhY2NvdW50IHR5cGUgdmFsdWVzIGNhbiBiZSBmb3VuZCBpbiBtb2JpbGUgTVQgYXBwbGljYXRpb24gb3JcbiAgICogaW4gTVQgdGVybWluYWwgZG93bmxvYWRlZCBmcm9tIG91ciBicm9rZXJcbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IGJhbGFuY2UgYWNjb3VudCBiYWxhbmNlXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBlbWFpbCBhY2NvdW50IGhvbGRlcidzIGVtYWlsXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBsZXZlcmFnZSBhY2NvdW50IGxldmVyYWdlXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIGFjY291bnQgaG9sZGVyJ3MgbmFtZVxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gcGhvbmUgYWNjb3VudCBob2xkZXIncyBwaG9uZSwgaW4gaW50ZXJuYXRpb25hbCBmb3JtYXRcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IHNlcnZlck5hbWUgc2VydmVyIG5hbWVcbiAgICovXG5cbiAgLyoqXG4gICAqIE5ldyBNZXRhVHJhZGVyIDUgbGl2ZSBhY2NvdW50IHJlcXVlc3QgbW9kZWxcbiAgICogQHR5cGVkZWYge09iamVjdH0gTmV3TVQ1TGl2ZUFjY291bnRcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IGFjY291bnRUeXBlIGFjY291bnQgdHlwZS4gQXZhaWxhYmxlIGFjY291bnQgdHlwZSB2YWx1ZXMgY2FuIGJlIGZvdW5kIGluIG1vYmlsZSBNVCBhcHBsaWNhdGlvbiBvclxuICAgKiBpbiBNVCB0ZXJtaW5hbCBkb3dubG9hZGVkIGZyb20gb3VyIGJyb2tlclxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gYWRkcmVzcyBhY2NvdW50IGhvbGRlcidzIGFkZHJlc3NcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IGNpdHkgYWNjb3VudCBob2xkZXIncyBjaXR5XG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBjb3VudHJ5IGFjY291bnQgaG9sZGVyJ3MgY291bnRyeVxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gZW1haWwgYWNjb3VudCBob2xkZXIncyBlbWFpbFxuICAgKiBAcHJvcGVydHkge251bWJlcn0gbGV2ZXJhZ2UgYWNjb3VudCBsZXZlcmFnZVxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSBhY2NvdW50IGhvbGRlcidzIG5hbWVcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IHBob25lIGFjY291bnQgaG9sZGVyJ3MgcGhvbmUsIGluIGludGVybmF0aW9uYWwgZm9ybWF0XG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzZXJ2ZXJOYW1lIHNlcnZlciBuYW1lXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzdGF0ZSBhY2NvdW50IGhvbGRlcidzIHN0YXRlXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSB6aXAgemlwIGFkZHJlc3NcbiAgICovXG5cbiAgLyoqXG4gICAqIE1ldGFUcmFkZXIgYWNjb3VudCBjcmVkZXRpYWxzIG1vZGVsXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IE1ldGF0cmFkZXJBY2NvdW50Q3JlZGVudGlhbHNEdG9cbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IGxvZ2luIGFjY291bnQgbG9naW5cbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IHBhc3N3b3JkIGFjY291bnQgcGFzc3dvcmRcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IHNlcnZlck5hbWUgTWV0YVRyYWRlciBzZXJ2ZXIgbmFtZVxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gaW52ZXN0b3JQYXNzd29yZCBhY2NvdW50IGludmVzdG9yIChyZWFkLW9ubHkpIHBhc3N3b3JkXG4gICAqL1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIG5ldyBNZXRhVHJhZGVyIDQgZGVtbyBhY2NvdW50XG4gICAqIFNlZSBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2dlbmVyYXRlQWNjb3VudC9jcmVhdGVNVDREZW1vQWNjb3VudC9cbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtOZXdNVDREZW1vQWNjb3VudH0gYWNjb3VudCBhY2NvdW50IHRvIGNyZWF0ZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gW3Byb2ZpbGVJZF0gaWQgb2YgdGhlIHByb3Zpc2lvbmluZyBwcm9maWxlIHRoYXQgd2lsbCBiZSB1c2VkIGFzIHRoZSBiYXNpcyBmb3IgY3JlYXRpbmcgdGhpcyBhY2NvdW50XG4gICAqIEByZXR1cm4ge1Byb21pc2U8TWV0YXRyYWRlckFjY291bnRDcmVkZW50aWFsc0R0bz59IHByb21pc2UgcmVzb2x2aW5nIHdpdGggTWV0YVRyYWRlciBhY2NvdW50IGNyZWRldGlhbHNcbiAgICovXG4gIGNyZWF0ZU1UNERlbW9BY2NvdW50KGFjY291bnQsIHByb2ZpbGVJZCkge1xuICAgIGlmICh0aGlzLl9pc05vdEp3dFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCdjcmVhdGVNVDREZW1vQWNjb3VudCcpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L3Byb3Zpc2lvbmluZy1wcm9maWxlcy8ke3Byb2ZpbGVJZCB8fCAnZGVmYXVsdCd9L210NC1kZW1vLWFjY291bnRzYCxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnYXV0aC10b2tlbic6IHRoaXMuX3Rva2VuXG4gICAgICB9LFxuICAgICAganNvbjogdHJ1ZSxcbiAgICAgIGJvZHk6IGFjY291bnRcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ2NyZWF0ZU1UNERlbW9BY2NvdW50Jyk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBuZXcgTWV0YVRyYWRlciA0IGxpdmUgYWNjb3VudFxuICAgKiBTZWUgaHR0cHM6Ly9tZXRhYXBpLmNsb3VkL2RvY3MvcHJvdmlzaW9uaW5nL2FwaS9nZW5lcmF0ZUFjY291bnQvY3JlYXRlTVQ0TGl2ZUFjY291bnQvXG4gICAqIE1ldGhvZCBpcyBhY2Nlc3NpYmxlIG9ubHkgd2l0aCBBUEkgYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSB7TmV3TVQ0TGl2ZUFjY291bnR9IGFjY291bnQgYWNjb3VudCB0byBjcmVhdGVcbiAgICogQHBhcmFtIHtzdHJpbmd9IFtwcm9maWxlSWRdIGlkIG9mIHRoZSBwcm92aXNpb25pbmcgcHJvZmlsZSB0aGF0IHdpbGwgYmUgdXNlZCBhcyB0aGUgYmFzaXMgZm9yIGNyZWF0aW5nIHRoaXMgYWNjb3VudFxuICAgKiBAcmV0dXJuIHtQcm9taXNlPE1ldGF0cmFkZXJBY2NvdW50Q3JlZGVudGlhbHNEdG8+fSBwcm9taXNlIHJlc29sdmluZyB3aXRoIE1ldGFUcmFkZXIgYWNjb3VudCBjcmVkZXRpYWxzXG4gICAqL1xuICBjcmVhdGVNVDRMaXZlQWNjb3VudChhY2NvdW50LCBwcm9maWxlSWQpIHtcbiAgICBpZiAodGhpcy5faXNOb3RKd3RUb2tlbigpKSB7XG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlTm9BY2Nlc3NFcnJvcignY3JlYXRlTVQ0TGl2ZUFjY291bnQnKTtcbiAgICB9XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVybDogYCR7dGhpcy5faG9zdH0vdXNlcnMvY3VycmVudC9wcm92aXNpb25pbmctcHJvZmlsZXMvJHtwcm9maWxlSWQgfHwgJ2RlZmF1bHQnfS9tdDQtbGl2ZS1hY2NvdW50c2AsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWUsXG4gICAgICBib2R5OiBhY2NvdW50XG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICdjcmVhdGVNVDRMaXZlQWNjb3VudCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgbmV3IE1ldGFUcmFkZXIgNSBkZW1vIGFjY291bnQuXG4gICAqIFNlZSBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2dlbmVyYXRlQWNjb3VudC9jcmVhdGVNVDVEZW1vQWNjb3VudC9cbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtOZXdNVDVEZW1vQWNjb3VudH0gYWNjb3VudCBhY2NvdW50IHRvIGNyZWF0ZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gW3Byb2ZpbGVJZF0gaWQgb2YgdGhlIHByb3Zpc2lvbmluZyBwcm9maWxlIHRoYXQgd2lsbCBiZSB1c2VkIGFzIHRoZSBiYXNpcyBmb3IgY3JlYXRpbmcgdGhpcyBhY2NvdW50XG4gICAqIEByZXR1cm4ge1Byb21pc2U8TWV0YXRyYWRlckFjY291bnRDcmVkZW50aWFsc0R0bz59IHByb21pc2UgcmVzb2x2aW5nIHdpdGggTWV0YVRyYWRlciBhY2NvdW50IGNyZWRlbnRpYWxzXG4gICAqL1xuICBjcmVhdGVNVDVEZW1vQWNjb3VudChhY2NvdW50LCBwcm9maWxlSWQpIHtcbiAgICBpZiAodGhpcy5faXNOb3RKd3RUb2tlbigpKSB7XG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlTm9BY2Nlc3NFcnJvcignY3JlYXRlTVQ1RGVtb0FjY291bnQnKTtcbiAgICB9XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVybDogYCR7dGhpcy5faG9zdH0vdXNlcnMvY3VycmVudC9wcm92aXNpb25pbmctcHJvZmlsZXMvJHtwcm9maWxlSWQgfHwgJ2RlZmF1bHQnfS9tdDUtZGVtby1hY2NvdW50c2AsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWUsXG4gICAgICBib2R5OiBhY2NvdW50XG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICdjcmVhdGVNVDVEZW1vQWNjb3VudCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgbmV3IE1ldGFUcmFkZXIgNSBsaXZlIGFjY291bnQuXG4gICAqIFNlZSBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2dlbmVyYXRlQWNjb3VudC9jcmVhdGVNVDVMaXZlQWNjb3VudC9cbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtOZXdNVDVMaXZlQWNjb3VudH0gYWNjb3VudCBhY2NvdW50IHRvIGNyZWF0ZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gW3Byb2ZpbGVJZF0gaWQgb2YgdGhlIHByb3Zpc2lvbmluZyBwcm9maWxlIHRoYXQgd2lsbCBiZSB1c2VkIGFzIHRoZSBiYXNpcyBmb3IgY3JlYXRpbmcgdGhpcyBhY2NvdW50XG4gICAqIEByZXR1cm4ge1Byb21pc2U8TWV0YXRyYWRlckFjY291bnRDcmVkZW50aWFsc0R0bz59IHByb21pc2UgcmVzb2x2aW5nIHdpdGggTWV0YVRyYWRlciBhY2NvdW50IGNyZWRlbnRpYWxzXG4gICAqL1xuICBjcmVhdGVNVDVMaXZlQWNjb3VudChhY2NvdW50LCBwcm9maWxlSWQpIHtcbiAgICBpZiAodGhpcy5faXNOb3RKd3RUb2tlbigpKSB7XG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlTm9BY2Nlc3NFcnJvcignY3JlYXRlTVQ1TGl2ZUFjY291bnQnKTtcbiAgICB9XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVybDogYCR7dGhpcy5faG9zdH0vdXNlcnMvY3VycmVudC9wcm92aXNpb25pbmctcHJvZmlsZXMvJHtwcm9maWxlSWQgfHwgJ2RlZmF1bHQnfS9tdDUtbGl2ZS1hY2NvdW50c2AsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWUsXG4gICAgICBib2R5OiBhY2NvdW50XG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICdjcmVhdGVNVDVMaXZlQWNjb3VudCcpO1xuICB9XG5cbn1cbiJdfQ==