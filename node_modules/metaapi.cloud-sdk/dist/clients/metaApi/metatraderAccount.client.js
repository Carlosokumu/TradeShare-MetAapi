'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _metaApi = require('../metaApi.client');

var _metaApi2 = _interopRequireDefault(_metaApi);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * metaapi.cloud MetaTrader account API client (see https://metaapi.cloud/docs/provisioning/)
 */
class MetatraderAccountClient extends _metaApi2.default {

  /**
   * Extension model
   * @typedef Extension
   * @property {String} id extension id
   * @property {Object} configuration extension configuration
   */

  /**
   * Metatrader account replica model
   * @typedef {Object} MetatraderAccountReplicaDto
   * @property {String} _id account unique identifier
   * @property {String} name MetaTrader account human-readable name in the MetaApi app
   * @property {String} type account type, can be cloud, cloud-g1, cloud-g2 or self-hosted. Cloud and cloud-g2 are
   * aliases.
   * @property {String} login MetaTrader account number
   * @property {String} server MetaTrader server which hosts the account
   * @property {Version} version MT version
   * @property {String} [provisioningProfileId] id of the account's provisioning profile
   * @property {String} application application name to connect the account to. Currently allowed values are MetaApi
   * and AgiliumTrade
   * @property {Number} magic MetaTrader magic to place trades using
   * @property {String} state account deployment state. One of CREATED, DEPLOYING, DEPLOYED, UNDEPLOYING, UNDEPLOYED,
   * DELETING
   * @property {String} connectionStatus terminal & broker connection status, one of CONNECTED, DISCONNECTED,
   * DISCONNECTED_FROM_BROKER
   * @property {String} accessToken authorization token to be used for accessing single account data.
   * Intended to be used in browser API.
   * @property {Boolean} [manualTrades] flag indicating if trades should be placed as manual trades. Default is false.
   * Supported on G2 only
   * @property {Number} quoteStreamingIntervalInSeconds Quote streaming interval in seconds. Set to 0 in order to
   * receive quotes on each tick. Default value is 2.5 seconds. Intervals less than 2.5 seconds are supported
   * only for G2
   * @property {Array<string>} [tags] MetaTrader account tags
   * @property {Object} [metadata] extra information which can be stored together with your account
   * @property {String} [reliability] used to increase the reliability of the account. Allowed values are regular and
   * high. Default is regular
   * @property {String} [baseCurrency] 3-character ISO currency code of the account base currency. Default value is USD.
   * The setting is to be used for copy trading accounts which use national currencies only, such as some Brazilian
   * brokers. You should not alter this setting unless you understand what you are doing.
   * @property {Array<string>} [copyFactoryRoles] Account roles for CopyFactory2 application. Allowed values are
   * `PROVIDER` and `SUBSCRIBER`
   * @property {Number} [resourceSlots] Number of resource slots to allocate to account. Allocating extra resource slots
   * results in better account performance under load which is useful for some applications. E.g. if you have many
   * accounts copying the same strategy via CooyFactory API, then you can increase resourceSlots to get a lower trade
   * copying latency. Please note that allocating extra resource slots is a paid option. Please note that high
   * reliability accounts use redundant infrastructure, so that each resource slot for a high reliability account
   * is billed as 2 standard resource slots.  Default is 1.
   * @property {number} [copyFactoryResourceSlots] Number of CopyFactory 2 resource slots to allocate to account.
   * Allocating extra resource slots results in lower trade copying latency. Please note that allocating extra resource
   * slots is a paid option. Please also note that CopyFactory 2 uses redundant infrastructure so that
   * each CopyFactory resource slot is billed as 2 standard resource slots. You will be billed for CopyFactory 2
   * resource slots only if you have added your account to CopyFactory 2 by specifying copyFactoryRoles field.
   * Default is 1.
   * @property {String} [symbol] any symbol provided by broker (required for G1 only) 
   * @property {String} region region id to deploy account at. One of returned by the /users/current/regions endpoint
   * @property {Number} [slippage] default trade slippage in points. Should be greater or equal to zero. If not
   * specified, system internal setting will be used which we believe is reasonable for most cases
   */

  /**
   * MetaTrader account model
   * @typedef {Object} MetatraderAccountDto
   * @property {String} _id account unique identifier
   * @property {String} userId user id
   * @property {String} name MetaTrader account human-readable name in the MetaApi app
   * @property {String} type account type, can be cloud, cloud-g1, cloud-g2 or self-hosted. Cloud and cloud-g2 are
   * aliases.
   * @property {String} login MetaTrader account number
   * @property {String} server MetaTrader server which hosts the account
   * @property {Version} version MT version
   * @property {String} [provisioningProfileId] id of the account's provisioning profile
   * @property {String} application application name to connect the account to. Currently allowed values are MetaApi
   * and AgiliumTrade
   * @property {Number} magic MetaTrader magic to place trades using
   * @property {String} state account deployment state. One of CREATED, DEPLOYING, DEPLOYED, UNDEPLOYING, UNDEPLOYED,
   * DELETING
   * @property {String} connectionStatus terminal & broker connection status, one of CONNECTED, DISCONNECTED,
   * DISCONNECTED_FROM_BROKER
   * @property {String} accessToken authorization token to be used for accessing single account data.
   * Intended to be used in browser API.
   * @property {Boolean} [manualTrades] flag indicating if trades should be placed as manual trades. Default is false.
   * Supported on G2 only
   * @property {Number} quoteStreamingIntervalInSeconds Quote streaming interval in seconds. Set to 0 in order to
   * receive quotes on each tick. Default value is 2.5 seconds. Intervals less than 2.5 seconds are supported
   * only for G2
   * @property {Array<string>} [tags] MetaTrader account tags
   * @property {Object} [metadata] extra information which can be stored together with your account
   * @property {String} reliability used to increase the reliability of the account. Allowed values are regular and
   * high. Default is regular
   * @property {String} [baseCurrency] 3-character ISO currency code of the account base currency. Default value is USD.
   * The setting is to be used for copy trading accounts which use national currencies only, such as some Brazilian
   * brokers. You should not alter this setting unless you understand what you are doing.
   * @property {Array<string>} [copyFactoryRoles] Account roles for CopyFactory2 application. Allowed values are
   * `PROVIDER` and `SUBSCRIBER`
   * @property {Number} resourceSlots Number of resource slots to allocate to account. Allocating extra resource slots
   * results in better account performance under load which is useful for some applications. E.g. if you have many
   * accounts copying the same strategy via CooyFactory API, then you can increase resourceSlots to get a lower trade
   * copying latency. Please note that allocating extra resource slots is a paid option. Please note that high
   * reliability accounts use redundant infrastructure, so that each resource slot for a high reliability account
   * is billed as 2 standard resource slots.  Default is 1.
   * @property {number} [copyFactoryResourceSlots] Number of CopyFactory 2 resource slots to allocate to account.
   * Allocating extra resource slots results in lower trade copying latency. Please note that allocating extra resource
   * slots is a paid option. Please also note that CopyFactory 2 uses redundant infrastructure so that
   * each CopyFactory resource slot is billed as 2 standard resource slots. You will be billed for CopyFactory 2
   * resource slots only if you have added your account to CopyFactory 2 by specifying copyFactoryRoles field.
   * Default is 1.
   * @property {String} [symbol] any symbol provided by broker (required for G1 only) 
   * @property {String} region region id to deploy account at. One of returned by the /users/current/regions endpoint
   * @property {Number} [slippage] default trade slippage in points. Should be greater or equal to zero. If not
   * specified, system internal setting will be used which we believe is reasonable for most cases
   * @property {Boolean} [primaryReplica] flag indicating that account is primary
   * @property {Boolean} [riskManagementApiEnabled] flag indicating that risk management API should be enabled on
   * account. Default is false
   * @property {Array<MetatraderAccountReplicaDto>} [accountReplicas] MetaTrader account replicas
   * @property {Array<AccountConnection>} connections active account connections
   */

  /**
   * Account connection
   * @typedef {Object} AccountConnection
   * @property {string} region region the account is connected at
   * @property {string} zone availability zone the account is connected at
   * @property {string} application application the account is connected to, one of `MetaApi`, `CopyFactory subscriber`,
   * `CopyFactory provider`, `CopyFactory history import`, `Risk management`
   */

  /**
   * MT version
   * @typedef {4 | 5} Version
   */

  /**
   * Account type
   * @typedef {'cloud' | 'self-hosted'} Type
   */

  /**
   * Account state
   * @typedef {'CREATED' | 'DEPLOYING' | 'DEPLOYED' | 'DEPLOY_FAILED' | 'UNDEPLOYING' | 'UNDEPLOYED' |
   * 'UNDEPLOY_FAILED' | 'DELETING' | 'DELETE_FAILED' | 'REDEPLOY_FAILED'} State
   */

  /**
   * Account connection status
   * @typedef {'CONNECTED' | 'DISCONNECTED' | 'DISCONNECTED_FROM_BROKER'} ConnectionStatus
   */

  /**
   * @typedef {Object} AccountsFilter
   * @property {Number} [offset] search offset (defaults to 0) (must be greater or equal to 0)
   * @property {Number} [limit] search limit (defaults to 1000) 
   * (must be greater or equal to 1 and less or equal to 1000)
   * @property {Array<Version> | Version} [version] MT version
   * @property {Array<Type> | Type} [type] account type
   * @property {Array<State> | State} [state] account state
   * @property {Array<ConnectionStatus> | ConnectionStatus} [connectionStatus] connection status
   * @property {String} [query] searches over _id, name, server and login to match query
   * @property {String} [provisioningProfileId] provisioning profile id
   */

  /**
   * Retrieves MetaTrader accounts owned by user (see https://metaapi.cloud/docs/provisioning/api/account/readAccounts/)
   * Method is accessible only with API access token
   * @param {AccountsFilter} accountsFilter optional filter
   * @return {Promise<Array<MetatraderAccountDto>>} promise resolving with MetaTrader accounts found
   */
  getAccounts(accountsFilter = {}) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('getAccounts');
    }
    const opts = {
      url: `${this._host}/users/current/accounts`,
      method: 'GET',
      qs: accountsFilter,
      headers: {
        'auth-token': this._token
      },
      json: true
    };
    return this._httpClient.request(opts, 'getAccounts');
  }

  /**
   * Retrieves a MetaTrader account by id (see https://metaapi.cloud/docs/provisioning/api/account/readAccount/). Throws
   * an error if account is not found.
   * @param {String} id MetaTrader account id
   * @return {Promise<MetatraderAccountDto>} promise resolving with MetaTrader account found
   */
  getAccount(id) {
    const opts = {
      url: `${this._host}/users/current/accounts/${id}`,
      method: 'GET',
      headers: {
        'auth-token': this._token
      },
      json: true
    };
    return this._httpClient.request(opts, 'getAccount');
  }

  /**
   * Retrieves a MetaTrader account replica by id (see 
   * https://metaapi.cloud/docs/provisioning/api/accountReplica/readAccountReplica/).
   * Throws an error if account is not found.
   * @param {String} primaryAccountId MetaTrader account id
   * @param {String} replicaId MetaTrader account replica id
   * @return {Promise<MetatraderAccountReplicaDto>} promise resolving with MetaTrader account replica found
   */
  getAccountReplica(primaryAccountId, replicaId) {
    const opts = {
      url: `${this._host}/users/current/accounts/${primaryAccountId}/replicas/${replicaId}`,
      method: 'GET',
      headers: {
        'auth-token': this._token
      },
      json: true
    };
    return this._httpClient.request(opts, 'getAccountReplica');
  }

  /**
   * Retrieves a MetaTrader account by token (see https://metaapi.cloud/docs/provisioning/api/account/readAccount/).
   * Throws an error if account is not found.
   * Method is accessible only with account access token
   * @return {Promise<MetatraderAccountDto>} promise resolving with MetaTrader account found
   */
  getAccountByToken() {
    if (this._isNotAccountToken()) {
      return this._handleNoAccessError('getAccountByToken');
    }
    const opts = {
      url: `${this._host}/users/current/accounts/accessToken/${this._token}`,
      method: 'GET',
      json: true
    };
    return this._httpClient.request(opts, 'getAccountByToken');
  }

  /**
   * New MetaTrader account model
   * @typedef {Object} NewMetatraderAccountDto
   * @property {String} name MetaTrader account human-readable name in the MetaApi app
   * @property {String} [type] account type, can be cloud, cloud-g1, cloud-g2 or self-hosted. cloud-g2 and cloud are
   * aliases. When you create MT5 cloud account the type is automatically converted to cloud-g1 because MT5 G2 support
   * is still experimental. You can still create MT5 G2 account by setting type to cloud-g2.
   * @property {String} login MetaTrader account number
   * @property {String} password MetaTrader account password. The password can be either investor password for read-only
   * access or master password to enable trading features. Required for cloud account
   * @property {String} server MetaTrader server which hosts the account
   * @property {String} [platform] platform id (mt4 or mt5)
   * @property {String} [provisioningProfileId] id of the account's provisioning profile
   * @property {String} application application name to connect the account to. Currently allowed values are MetaApi and
   * AgiliumTrade
   * @property {Number} magic MetaTrader magic to place trades using. When manualTrades field is set to true,
   * magic value must be 0
   * @property {Boolean} [manualTrades] flag indicating if trades should be placed as manual trades. Default is false
   * @property {Number} [quoteStreamingIntervalInSeconds] Quote streaming interval in seconds. Set to 0 in order to
   * receive quotes on each tick. Default value is 2.5 seconds. Intervals less than 2.5 seconds are supported
   * only for G2
   * @property {Array<string>} [tags] MetaTrader account tags
   * @property {Object} [metadata] extra information which can be stored together with your account
   * @property {String} [reliability] used to increase the reliability of the account. Allowed values are regular and high.
   * Default is regular
   * @property {String} [baseCurrency] 3-character ISO currency code of the account base currency. Default value is USD.
   * The setting is to be used for copy trading accounts which use national currencies only, such as some Brazilian
   * brokers. You should not alter this setting unless you understand what you are doing.
   * @property {Array<string>} [copyFactoryRoles] Account roles for CopyFactory2 application. Allowed values are
   * `PROVIDER` and `SUBSCRIBER`
   * @property {Number} [resourceSlots] Number of resource slots to allocate to account. Allocating extra resource slots
   * results in better account performance under load which is useful for some applications. E.g. if you have many
   * accounts copying the same strategy via CooyFactory API, then you can increase resourceSlots to get a lower trade
   * copying latency. Please note that allocating extra resource slots is a paid option. Default is 1
   * @property {String} [symbol] any MetaTrader symbol your broker provides historical market data for. This value
   * should be specified for G1 accounts only and only in case your MT account fails to connect to broker
   * @property {number} [copyFactoryResourceSlots] Number of CopyFactory 2 resource slots to allocate to account.
   * Allocating extra resource slots results in lower trade copying latency. Please note that allocating extra resource
   * slots is a paid option. Please also note that CopyFactory 2 uses redundant infrastructure so that
   * each CopyFactory resource slot is billed as 2 standard resource slots. You will be billed for CopyFactory 2
   * resource slots only if you have added your account to CopyFactory 2 by specifying copyFactoryRoles field.
   * Default is 1.
   * @property {String} [region] region id to deploy account at. One of returned by the /users/current/regions endpoint
   * @property {Number} [slippage] default trade slippage in points. Should be greater or equal to zero. If not
   * specified, system internal setting will be used which we believe is reasonable for most cases
   */

  /**
   * MetaTrader account id model
   * @typedef {Object} MetatraderAccountIdDto
   * @property {String} id MetaTrader account unique identifier
   */

  /**
   * Starts cloud API server for a MetaTrader account using specified provisioning profile (see
   * https://metaapi.cloud/docs/provisioning/api/account/createAccount/). It takes some time to launch the terminal and
   * connect the terminal to the broker, you can use the connectionStatus field to monitor the current status of the
   * terminal.
   * Method is accessible only with API access token
   * @param {NewMetatraderAccountDto} account MetaTrader account to create
   * @return {Promise<MetatraderAccountIdDto>} promise resolving with an id of the MetaTrader account created
   */
  createAccount(account) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('createAccount');
    }
    const opts = {
      url: `${this._host}/users/current/accounts`,
      method: 'POST',
      headers: {
        'auth-token': this._token
      },
      json: true,
      body: account
    };
    return this._httpClient.request(opts, 'createAccount');
  }

  /**
   * New MetaTrader account replica model
   * @typedef {Object} NewMetaTraderAccountReplicaDto
   * @property {String} [symbol] any symbol provided by broker (required for G1 only) 
   * @property {Number} magic MetaTrader magic to place trades using
   * @property {Number} [quoteStreamingIntervalInSeconds] Quote streaming interval in seconds. Set to 0 in order to
   * receive quotes on each tick. Default value is 2.5 seconds. Intervals less than 2.5 seconds are supported
   * only for G2
   * @property {Array<string>} [tags] MetaTrader account tags
   * @property {Object} [metadata] extra information which can be stored together with your account
   * @property {String} [reliability] used to increase the reliability of the account. Allowed values are regular and high.
   * Default is regular
   * @property {Number} [resourceSlots] number of resource slots to allocate to account. Allocating extra resource slots
   * results in better account performance under load which is useful for some applications. E.g. if you have many
   * accounts copying the same strategy via CooyFactory API, then you can increase resourceSlots to get a lower trade
   * copying latency. Please note that allocating extra resource slots is a paid option. Default is 1
   * @property {number} [copyFactoryResourceSlots] number of CopyFactory 2 resource slots to allocate to account.
   * Allocating extra resource slots results in lower trade copying latency. Please note that allocating extra resource
   * slots is a paid option. Please also note that CopyFactory 2 uses redundant infrastructure so that
   * each CopyFactory resource slot is billed as 2 standard resource slots. You will be billed for CopyFactory 2
   * resource slots only if you have added your account to CopyFactory 2 by specifying copyFactoryRoles field.
   * Default is 1.
   * @property {String} region region id to deploy account at. One of returned by the /users/current/regions endpoint
   */

  /**
   * Starts cloud API server for a MetaTrader account replica using specified primary account (see
   * https://metaapi.cloud/docs/provisioning/api/accountReplica/createAccountReplica/). It takes some time to launch the terminal and
   * connect the terminal to the broker, you can use the connectionStatus field to monitor the current status of the
   * terminal.
   * Method is accessible only with API access token
   * @param {String} accountId primary MetaTrader account id
   * @param {NewMetaTraderAccountReplicaDto} replica MetaTrader account to create
   * @return {Promise<MetatraderAccountIdDto>} promise resolving with an id of the MetaTrader account replica created
   */
  createAccountReplica(accountId, replica) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('createAccountReplica');
    }
    const opts = {
      url: `${this._host}/users/current/accounts/${accountId}/replicas`,
      method: 'POST',
      headers: {
        'auth-token': this._token
      },
      json: true,
      body: replica
    };
    return this._httpClient.request(opts, 'createAccountReplica');
  }

  /**
   * Starts API server for MetaTrader account. This request will be ignored if the account has already been deployed.
   * (see https://metaapi.cloud/docs/provisioning/api/account/deployAccount/)
   * @param {String} id MetaTrader account id to deploy
   * @return {Promise} promise resolving when MetaTrader account is scheduled for deployment
   */
  deployAccount(id) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('deployAccount');
    }
    const opts = {
      url: `${this._host}/users/current/accounts/${id}/deploy`,
      method: 'POST',
      headers: {
        'auth-token': this._token
      },
      json: true
    };
    return this._httpClient.request(opts, 'deployAccount');
  }

  /**
   * Starts API server for MetaTrader account replica. This request will be ignored if the replica has already been deployed.
   * (see https://metaapi.cloud/docs/provisioning/api/accountReplica/deployAccountReplica/)
   * @param {String} primaryAccountId MetaTrader account id
   * @param {String} replicaId MetaTrader account replica id to deploy
   * @return {Promise} promise resolving when MetaTrader account replica is scheduled for deployment
   */
  deployAccountReplica(primaryAccountId, replicaId) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('deployAccountReplica');
    }
    const opts = {
      url: `${this._host}/users/current/accounts/${primaryAccountId}/replicas/${replicaId}/deploy`,
      method: 'POST',
      headers: {
        'auth-token': this._token
      },
      json: true
    };
    return this._httpClient.request(opts, 'deployAccountReplica');
  }

  /**
   * Stops API server for a MetaTrader account. Terminal data such as downloaded market history data will be preserved.
   * (see https://metaapi.cloud/docs/provisioning/api/account/undeployAccount/)
   * @param {String} id MetaTrader account id to undeploy
   * @return {Promise} promise resolving when MetaTrader account is scheduled for undeployment
   */
  undeployAccount(id) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('undeployAccount');
    }
    const opts = {
      url: `${this._host}/users/current/accounts/${id}/undeploy`,
      method: 'POST',
      headers: {
        'auth-token': this._token
      },
      json: true
    };
    return this._httpClient.request(opts, 'undeployAccount');
  }

  /**
   * Stops API server for MetaTrader account replica. Terminal data such as downloaded market history data will be preserved.
   * (see https://metaapi.cloud/docs/provisioning/api/accountReplica/undeployAccountReplica/)
   * @param {String} primaryAccountId MetaTrader account id
   * @param {String} replicaId MetaTrader account replica id to undeploy
   * @return {Promise} promise resolving when MetaTrader account replica is scheduled for undeployment
   */
  undeployAccountReplica(primaryAccountId, replicaId) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('undeployAccountReplica');
    }
    const opts = {
      url: `${this._host}/users/current/accounts/${primaryAccountId}/replicas/${replicaId}/undeploy`,
      method: 'POST',
      headers: {
        'auth-token': this._token
      },
      json: true
    };
    return this._httpClient.request(opts, 'undeployAccountReplica');
  }

  /**
   * Redeploys MetaTrader account. This is equivalent to undeploy immediately followed by deploy.
   * (see https://metaapi.cloud/docs/provisioning/api/account/deployAccount/)
   * @param {String} id MetaTrader account id to redeploy
   * @return {Promise} promise resolving when MetaTrader account is scheduled for redeployment
   */
  redeployAccount(id) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('redeployAccount');
    }
    const opts = {
      url: `${this._host}/users/current/accounts/${id}/redeploy`,
      method: 'POST',
      headers: {
        'auth-token': this._token
      },
      json: true
    };
    return this._httpClient.request(opts, 'redeployAccount');
  }

  /**
   * Redeploys MetaTrader account. This is equivalent to undeploy immediately followed by deploy.
   * (see https://metaapi.cloud/docs/provisioning/api/account/redeployAccountReplica/)
   * @param {String} primaryAccountId MetaTrader account id
   * @param {String} replicaId MetaTrader account replica id to redeploy
   * @return {Promise} promise resolving when MetaTrader account replica is scheduled for redeployment
   */
  redeployAccountReplica(primaryAccountId, replicaId) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('redeployAccountReplica');
    }
    const opts = {
      url: `${this._host}/users/current/accounts/${primaryAccountId}/replicas/${replicaId}/redeploy`,
      method: 'POST',
      headers: {
        'auth-token': this._token
      },
      json: true
    };
    return this._httpClient.request(opts, 'redeployAccountReplica');
  }

  /**
   * Stops and deletes an API server for a specified MetaTrader account. The terminal state such as downloaded market
   * data history will be deleted as well when you delete the account. (see
   * https://metaapi.cloud/docs/provisioning/api/account/deleteAccount/).
   * Method is accessible only with API access token
   * @param {String} id MetaTrader account id
   * @return {Promise} promise resolving when MetaTrader account is scheduled for deletion
   */
  deleteAccount(id) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('deleteAccount');
    }
    const opts = {
      url: `${this._host}/users/current/accounts/${id}`,
      method: 'DELETE',
      headers: {
        'auth-token': this._token
      },
      json: true
    };
    return this._httpClient.request(opts, 'deleteAccount');
  }

  /**
   * Stops and deletes an API server for a specified MetaTrader account. The terminal state such as downloaded market
   * data history will be deleted as well when you delete the account. (see
   * https://metaapi.cloud/docs/provisioning/api/account/deleteAccountReplica/).
   * Method is accessible only with API access token
   * @param {String} primaryAccountId MetaTrader account id
   * @param {String} replicaId MetaTrader account replica id to delete
   * @return {Promise} promise resolving when MetaTrader account is scheduled for deletion
   */
  deleteAccountReplica(primaryAccountId, replicaId) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('deleteAccountReplica');
    }
    const opts = {
      url: `${this._host}/users/current/accounts/${primaryAccountId}/replicas/${replicaId}`,
      method: 'DELETE',
      headers: {
        'auth-token': this._token
      },
      json: true
    };
    return this._httpClient.request(opts, 'deleteAccountReplica');
  }

  /**
   * Updated MetaTrader account data
   * @typedef {Object} MetatraderAccountUpdateDto
   * @property {String} name MetaTrader account human-readable name in the MetaApi app
   * @property {String} password MetaTrader account password. The password can be either investor password for read-only
   * access or master password to enable trading features. Required for cloud account
   * @property {String} server MetaTrader server which hosts the account
   * @property {Number} [magic] MetaTrader magic to place trades using
   * @property {Boolean} [manualTrades] flag indicating if trades should be placed as manual trades. Default is false
   * @property {Number} [quoteStreamingIntervalInSeconds] Quote streaming interval in seconds. Set to 0 in order to
   * receive quotes on each tick. Default value is 2.5 seconds. Intervals less than 2.5 seconds are supported
   * only for G2
   * @property {Array<string>} [tags] MetaTrader account tags
   * @property {Array<Extension>} [extensions] API extensions
   * @property {Object} [metadata] extra information which can be stored together with your account
   * @property {Array<string>} [copyFactoryRoles] Account roles for CopyFactory2 application. Allowed values are
   * `PROVIDER` and `SUBSCRIBER`
   * @property {Number} [resourceSlots] Number of resource slots to allocate to account. Allocating extra resource slots
   * results in better account performance under load which is useful for some applications. E.g. if you have many
   * accounts copying the same strategy via CooyFactory API, then you can increase resourceSlots to get a lower trade
   * copying latency. Please note that allocating extra resource slots is a paid option. Default is 1
   */

  /**
   * Updates existing metatrader account data (see
   * https://metaapi.cloud/docs/provisioning/api/account/updateAccount/).
   * Method is accessible only with API access token
   * @param {String} id MetaTrader account id
   * @param {MetatraderAccountUpdateDto} account updated MetaTrader account
   * @return {Promise} promise resolving when MetaTrader account is updated
   */
  updateAccount(id, account) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('updateAccount');
    }
    const opts = {
      url: `${this._host}/users/current/accounts/${id}`,
      method: 'PUT',
      headers: {
        'auth-token': this._token
      },
      json: true,
      body: account
    };
    return this._httpClient.request(opts, 'updateAccount');
  }

  /**
   * Updated MetaTrader account replica data
   * @typedef {Object} UpdatedMetatraderAccountReplicaDto
   * @property {Number} [magic] MetaTrader magic to place trades using
   * @property {Number} [quoteStreamingIntervalInSeconds] Quote streaming interval in seconds. Set to 0 in order to
   * receive quotes on each tick. Default value is 2.5 seconds. Intervals less than 2.5 seconds are supported
   * only for G2
   * @property {Array<string>} [tags] MetaTrader account tags
   * @property {Object} [metadata] extra information which can be stored together with your account
   * @property {Number} [resourceSlots] Number of resource slots to allocate to account. Allocating extra resource slots
   * results in better account performance under load which is useful for some applications. E.g. if you have many
   * accounts copying the same strategy via CooyFactory API, then you can increase resourceSlots to get a lower trade
   * copying latency. Please note that allocating extra resource slots is a paid option. Default is 1
   * @property {number} [copyFactoryResourceSlots] number of CopyFactory 2 resource slots to allocate to account.
   * Allocating extra resource slots results in lower trade copying latency. Please note that allocating extra resource
   * slots is a paid option. Please also note that CopyFactory 2 uses redundant infrastructure so that
   * each CopyFactory resource slot is billed as 2 standard resource slots. You will be billed for CopyFactory 2
   * resource slots only if you have added your account to CopyFactory 2 by specifying copyFactoryRoles field.
   * Default is 1.
   */

  /**
   * Updates existing metatrader account replica data (see
   * https://metaapi.cloud/docs/provisioning/api/account/updateAccountReplica/).
   * Method is accessible only with API access token
   * @param {String} primaryAccountId MetaTrader account id
   * @param {String} replicaId MetaTrader account replica id
   * @param {UpdatedMetatraderAccountReplicaDto} account updated MetaTrader account replica
   * @return {Promise} promise resolving when MetaTrader account replica is updated
   */
  updateAccountReplica(primaryAccountId, replicaId, account) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('updateAccountReplica');
    }
    const opts = {
      url: `${this._host}/users/current/accounts/${primaryAccountId}/replicas/${replicaId}`,
      method: 'PUT',
      headers: {
        'auth-token': this._token
      },
      json: true,
      body: account
    };
    return this._httpClient.request(opts, 'updateAccountReplica');
  }

  /**
   * Increases MetaTrader account reliability. The account will be temporary stopped to perform this action. (see
   * https://metaapi.cloud/docs/provisioning/api/account/increaseReliability/).
   * Method is accessible only with API access token
   * @param {String} id MetaTrader account id
   * @return {Promise} promise resolving when MetaTrader account reliability is increased
   */
  increaseReliability(id) {
    if (this._isNotJwtToken()) {
      return this._handleNoAccessError('increaseReliability');
    }
    const opts = {
      url: `${this._host}/users/current/accounts/${id}/increase-reliability`,
      method: 'POST',
      headers: {
        'auth-token': this._token
      },
      json: true
    };
    return this._httpClient.request(opts, 'increaseReliability');
  }

}
exports.default = MetatraderAccountClient;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9jbGllbnRzL21ldGFBcGkvbWV0YXRyYWRlckFjY291bnQuY2xpZW50LmVzNiJdLCJuYW1lcyI6WyJNZXRhdHJhZGVyQWNjb3VudENsaWVudCIsIk1ldGFBcGlDbGllbnQiLCJnZXRBY2NvdW50cyIsImFjY291bnRzRmlsdGVyIiwiX2lzTm90Snd0VG9rZW4iLCJfaGFuZGxlTm9BY2Nlc3NFcnJvciIsIm9wdHMiLCJ1cmwiLCJfaG9zdCIsIm1ldGhvZCIsInFzIiwiaGVhZGVycyIsIl90b2tlbiIsImpzb24iLCJfaHR0cENsaWVudCIsInJlcXVlc3QiLCJnZXRBY2NvdW50IiwiaWQiLCJnZXRBY2NvdW50UmVwbGljYSIsInByaW1hcnlBY2NvdW50SWQiLCJyZXBsaWNhSWQiLCJnZXRBY2NvdW50QnlUb2tlbiIsIl9pc05vdEFjY291bnRUb2tlbiIsImNyZWF0ZUFjY291bnQiLCJhY2NvdW50IiwiYm9keSIsImNyZWF0ZUFjY291bnRSZXBsaWNhIiwiYWNjb3VudElkIiwicmVwbGljYSIsImRlcGxveUFjY291bnQiLCJkZXBsb3lBY2NvdW50UmVwbGljYSIsInVuZGVwbG95QWNjb3VudCIsInVuZGVwbG95QWNjb3VudFJlcGxpY2EiLCJyZWRlcGxveUFjY291bnQiLCJyZWRlcGxveUFjY291bnRSZXBsaWNhIiwiZGVsZXRlQWNjb3VudCIsImRlbGV0ZUFjY291bnRSZXBsaWNhIiwidXBkYXRlQWNjb3VudCIsInVwZGF0ZUFjY291bnRSZXBsaWNhIiwiaW5jcmVhc2VSZWxpYWJpbGl0eSJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OztBQUVBOzs7Ozs7QUFFQTs7O0FBR2UsTUFBTUEsdUJBQU4sU0FBc0NDLGlCQUF0QyxDQUFvRDs7QUFFakU7Ozs7Ozs7QUFPQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQW9EQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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QUFNRDtBQVBLLEtBQWI7QUFTQSxXQUFPLEtBQUtWLFdBQUwsQ0FBaUJDLE9BQWpCLENBQXlCVCxJQUF6QixFQUErQixzQkFBL0IsQ0FBUDtBQUNEOztBQUVEOzs7Ozs7O0FBT0FpQyxzQkFBb0J0QixFQUFwQixFQUF3QjtBQUN0QixRQUFJLEtBQUtiLGNBQUwsRUFBSixFQUEyQjtBQUN6QixhQUFPLEtBQUtDLG9CQUFMLENBQTBCLHFCQUExQixDQUFQO0FBQ0Q7QUFDRCxVQUFNQyxPQUFPO0FBQ1hDLFdBQU0sR0FBRSxLQUFLQyxLQUFNLDJCQUEwQlMsRUFBRyx1QkFEckM7QUFFWFIsY0FBUSxNQUZHO0FBR1hFLGVBQVM7QUFDUCxzQkFBYyxLQUFLQztBQURaLE9BSEU7QUFNWEMsWUFBTTtBQU5LLEtBQWI7QUFRQSxXQUFPLEtBQUtDLFdBQUwsQ0FBaUJDLE9BQWpCLENBQXlCVCxJQUF6QixFQUErQixxQkFBL0IsQ0FBUDtBQUNEOztBQWxwQmdFO2tCQUE5Q04sdUIiLCJmaWxlIjoibWV0YXRyYWRlckFjY291bnQuY2xpZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgTWV0YUFwaUNsaWVudCBmcm9tICcuLi9tZXRhQXBpLmNsaWVudCc7XG5cbi8qKlxuICogbWV0YWFwaS5jbG91ZCBNZXRhVHJhZGVyIGFjY291bnQgQVBJIGNsaWVudCAoc2VlIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy8pXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1ldGF0cmFkZXJBY2NvdW50Q2xpZW50IGV4dGVuZHMgTWV0YUFwaUNsaWVudCB7XG5cbiAgLyoqXG4gICAqIEV4dGVuc2lvbiBtb2RlbFxuICAgKiBAdHlwZWRlZiBFeHRlbnNpb25cbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IGlkIGV4dGVuc2lvbiBpZFxuICAgKiBAcHJvcGVydHkge09iamVjdH0gY29uZmlndXJhdGlvbiBleHRlbnNpb24gY29uZmlndXJhdGlvblxuICAgKi9cblxuICAvKipcbiAgICogTWV0YXRyYWRlciBhY2NvdW50IHJlcGxpY2EgbW9kZWxcbiAgICogQHR5cGVkZWYge09iamVjdH0gTWV0YXRyYWRlckFjY291bnRSZXBsaWNhRHRvXG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBfaWQgYWNjb3VudCB1bmlxdWUgaWRlbnRpZmllclxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gbmFtZSBNZXRhVHJhZGVyIGFjY291bnQgaHVtYW4tcmVhZGFibGUgbmFtZSBpbiB0aGUgTWV0YUFwaSBhcHBcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IHR5cGUgYWNjb3VudCB0eXBlLCBjYW4gYmUgY2xvdWQsIGNsb3VkLWcxLCBjbG91ZC1nMiBvciBzZWxmLWhvc3RlZC4gQ2xvdWQgYW5kIGNsb3VkLWcyIGFyZVxuICAgKiBhbGlhc2VzLlxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gbG9naW4gTWV0YVRyYWRlciBhY2NvdW50IG51bWJlclxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gc2VydmVyIE1ldGFUcmFkZXIgc2VydmVyIHdoaWNoIGhvc3RzIHRoZSBhY2NvdW50XG4gICAqIEBwcm9wZXJ0eSB7VmVyc2lvbn0gdmVyc2lvbiBNVCB2ZXJzaW9uXG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBbcHJvdmlzaW9uaW5nUHJvZmlsZUlkXSBpZCBvZiB0aGUgYWNjb3VudCdzIHByb3Zpc2lvbmluZyBwcm9maWxlXG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBhcHBsaWNhdGlvbiBhcHBsaWNhdGlvbiBuYW1lIHRvIGNvbm5lY3QgdGhlIGFjY291bnQgdG8uIEN1cnJlbnRseSBhbGxvd2VkIHZhbHVlcyBhcmUgTWV0YUFwaVxuICAgKiBhbmQgQWdpbGl1bVRyYWRlXG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBtYWdpYyBNZXRhVHJhZGVyIG1hZ2ljIHRvIHBsYWNlIHRyYWRlcyB1c2luZ1xuICAgKiBAcHJvcGVydHkge1N0cmluZ30gc3RhdGUgYWNjb3VudCBkZXBsb3ltZW50IHN0YXRlLiBPbmUgb2YgQ1JFQVRFRCwgREVQTE9ZSU5HLCBERVBMT1lFRCwgVU5ERVBMT1lJTkcsIFVOREVQTE9ZRUQsXG4gICAqIERFTEVUSU5HXG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBjb25uZWN0aW9uU3RhdHVzIHRlcm1pbmFsICYgYnJva2VyIGNvbm5lY3Rpb24gc3RhdHVzLCBvbmUgb2YgQ09OTkVDVEVELCBESVNDT05ORUNURUQsXG4gICAqIERJU0NPTk5FQ1RFRF9GUk9NX0JST0tFUlxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gYWNjZXNzVG9rZW4gYXV0aG9yaXphdGlvbiB0b2tlbiB0byBiZSB1c2VkIGZvciBhY2Nlc3Npbmcgc2luZ2xlIGFjY291bnQgZGF0YS5cbiAgICogSW50ZW5kZWQgdG8gYmUgdXNlZCBpbiBicm93c2VyIEFQSS5cbiAgICogQHByb3BlcnR5IHtCb29sZWFufSBbbWFudWFsVHJhZGVzXSBmbGFnIGluZGljYXRpbmcgaWYgdHJhZGVzIHNob3VsZCBiZSBwbGFjZWQgYXMgbWFudWFsIHRyYWRlcy4gRGVmYXVsdCBpcyBmYWxzZS5cbiAgICogU3VwcG9ydGVkIG9uIEcyIG9ubHlcbiAgICogQHByb3BlcnR5IHtOdW1iZXJ9IHF1b3RlU3RyZWFtaW5nSW50ZXJ2YWxJblNlY29uZHMgUXVvdGUgc3RyZWFtaW5nIGludGVydmFsIGluIHNlY29uZHMuIFNldCB0byAwIGluIG9yZGVyIHRvXG4gICAqIHJlY2VpdmUgcXVvdGVzIG9uIGVhY2ggdGljay4gRGVmYXVsdCB2YWx1ZSBpcyAyLjUgc2Vjb25kcy4gSW50ZXJ2YWxzIGxlc3MgdGhhbiAyLjUgc2Vjb25kcyBhcmUgc3VwcG9ydGVkXG4gICAqIG9ubHkgZm9yIEcyXG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8c3RyaW5nPn0gW3RhZ3NdIE1ldGFUcmFkZXIgYWNjb3VudCB0YWdzXG4gICAqIEBwcm9wZXJ0eSB7T2JqZWN0fSBbbWV0YWRhdGFdIGV4dHJhIGluZm9ybWF0aW9uIHdoaWNoIGNhbiBiZSBzdG9yZWQgdG9nZXRoZXIgd2l0aCB5b3VyIGFjY291bnRcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IFtyZWxpYWJpbGl0eV0gdXNlZCB0byBpbmNyZWFzZSB0aGUgcmVsaWFiaWxpdHkgb2YgdGhlIGFjY291bnQuIEFsbG93ZWQgdmFsdWVzIGFyZSByZWd1bGFyIGFuZFxuICAgKiBoaWdoLiBEZWZhdWx0IGlzIHJlZ3VsYXJcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IFtiYXNlQ3VycmVuY3ldIDMtY2hhcmFjdGVyIElTTyBjdXJyZW5jeSBjb2RlIG9mIHRoZSBhY2NvdW50IGJhc2UgY3VycmVuY3kuIERlZmF1bHQgdmFsdWUgaXMgVVNELlxuICAgKiBUaGUgc2V0dGluZyBpcyB0byBiZSB1c2VkIGZvciBjb3B5IHRyYWRpbmcgYWNjb3VudHMgd2hpY2ggdXNlIG5hdGlvbmFsIGN1cnJlbmNpZXMgb25seSwgc3VjaCBhcyBzb21lIEJyYXppbGlhblxuICAgKiBicm9rZXJzLiBZb3Ugc2hvdWxkIG5vdCBhbHRlciB0aGlzIHNldHRpbmcgdW5sZXNzIHlvdSB1bmRlcnN0YW5kIHdoYXQgeW91IGFyZSBkb2luZy5cbiAgICogQHByb3BlcnR5IHtBcnJheTxzdHJpbmc+fSBbY29weUZhY3RvcnlSb2xlc10gQWNjb3VudCByb2xlcyBmb3IgQ29weUZhY3RvcnkyIGFwcGxpY2F0aW9uLiBBbGxvd2VkIHZhbHVlcyBhcmVcbiAgICogYFBST1ZJREVSYCBhbmQgYFNVQlNDUklCRVJgXG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBbcmVzb3VyY2VTbG90c10gTnVtYmVyIG9mIHJlc291cmNlIHNsb3RzIHRvIGFsbG9jYXRlIHRvIGFjY291bnQuIEFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2Ugc2xvdHNcbiAgICogcmVzdWx0cyBpbiBiZXR0ZXIgYWNjb3VudCBwZXJmb3JtYW5jZSB1bmRlciBsb2FkIHdoaWNoIGlzIHVzZWZ1bCBmb3Igc29tZSBhcHBsaWNhdGlvbnMuIEUuZy4gaWYgeW91IGhhdmUgbWFueVxuICAgKiBhY2NvdW50cyBjb3B5aW5nIHRoZSBzYW1lIHN0cmF0ZWd5IHZpYSBDb295RmFjdG9yeSBBUEksIHRoZW4geW91IGNhbiBpbmNyZWFzZSByZXNvdXJjZVNsb3RzIHRvIGdldCBhIGxvd2VyIHRyYWRlXG4gICAqIGNvcHlpbmcgbGF0ZW5jeS4gUGxlYXNlIG5vdGUgdGhhdCBhbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzIGlzIGEgcGFpZCBvcHRpb24uIFBsZWFzZSBub3RlIHRoYXQgaGlnaFxuICAgKiByZWxpYWJpbGl0eSBhY2NvdW50cyB1c2UgcmVkdW5kYW50IGluZnJhc3RydWN0dXJlLCBzbyB0aGF0IGVhY2ggcmVzb3VyY2Ugc2xvdCBmb3IgYSBoaWdoIHJlbGlhYmlsaXR5IGFjY291bnRcbiAgICogaXMgYmlsbGVkIGFzIDIgc3RhbmRhcmQgcmVzb3VyY2Ugc2xvdHMuICBEZWZhdWx0IGlzIDEuXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbY29weUZhY3RvcnlSZXNvdXJjZVNsb3RzXSBOdW1iZXIgb2YgQ29weUZhY3RvcnkgMiByZXNvdXJjZSBzbG90cyB0byBhbGxvY2F0ZSB0byBhY2NvdW50LlxuICAgKiBBbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzIHJlc3VsdHMgaW4gbG93ZXIgdHJhZGUgY29weWluZyBsYXRlbmN5LiBQbGVhc2Ugbm90ZSB0aGF0IGFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2VcbiAgICogc2xvdHMgaXMgYSBwYWlkIG9wdGlvbi4gUGxlYXNlIGFsc28gbm90ZSB0aGF0IENvcHlGYWN0b3J5IDIgdXNlcyByZWR1bmRhbnQgaW5mcmFzdHJ1Y3R1cmUgc28gdGhhdFxuICAgKiBlYWNoIENvcHlGYWN0b3J5IHJlc291cmNlIHNsb3QgaXMgYmlsbGVkIGFzIDIgc3RhbmRhcmQgcmVzb3VyY2Ugc2xvdHMuIFlvdSB3aWxsIGJlIGJpbGxlZCBmb3IgQ29weUZhY3RvcnkgMlxuICAgKiByZXNvdXJjZSBzbG90cyBvbmx5IGlmIHlvdSBoYXZlIGFkZGVkIHlvdXIgYWNjb3VudCB0byBDb3B5RmFjdG9yeSAyIGJ5IHNwZWNpZnlpbmcgY29weUZhY3RvcnlSb2xlcyBmaWVsZC5cbiAgICogRGVmYXVsdCBpcyAxLlxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gW3N5bWJvbF0gYW55IHN5bWJvbCBwcm92aWRlZCBieSBicm9rZXIgKHJlcXVpcmVkIGZvciBHMSBvbmx5KSBcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IHJlZ2lvbiByZWdpb24gaWQgdG8gZGVwbG95IGFjY291bnQgYXQuIE9uZSBvZiByZXR1cm5lZCBieSB0aGUgL3VzZXJzL2N1cnJlbnQvcmVnaW9ucyBlbmRwb2ludFxuICAgKiBAcHJvcGVydHkge051bWJlcn0gW3NsaXBwYWdlXSBkZWZhdWx0IHRyYWRlIHNsaXBwYWdlIGluIHBvaW50cy4gU2hvdWxkIGJlIGdyZWF0ZXIgb3IgZXF1YWwgdG8gemVyby4gSWYgbm90XG4gICAqIHNwZWNpZmllZCwgc3lzdGVtIGludGVybmFsIHNldHRpbmcgd2lsbCBiZSB1c2VkIHdoaWNoIHdlIGJlbGlldmUgaXMgcmVhc29uYWJsZSBmb3IgbW9zdCBjYXNlc1xuICAgKi9cblxuICAvKipcbiAgICogTWV0YVRyYWRlciBhY2NvdW50IG1vZGVsXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IE1ldGF0cmFkZXJBY2NvdW50RHRvXG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBfaWQgYWNjb3VudCB1bmlxdWUgaWRlbnRpZmllclxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gdXNlcklkIHVzZXIgaWRcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IG5hbWUgTWV0YVRyYWRlciBhY2NvdW50IGh1bWFuLXJlYWRhYmxlIG5hbWUgaW4gdGhlIE1ldGFBcGkgYXBwXG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSB0eXBlIGFjY291bnQgdHlwZSwgY2FuIGJlIGNsb3VkLCBjbG91ZC1nMSwgY2xvdWQtZzIgb3Igc2VsZi1ob3N0ZWQuIENsb3VkIGFuZCBjbG91ZC1nMiBhcmVcbiAgICogYWxpYXNlcy5cbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IGxvZ2luIE1ldGFUcmFkZXIgYWNjb3VudCBudW1iZXJcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IHNlcnZlciBNZXRhVHJhZGVyIHNlcnZlciB3aGljaCBob3N0cyB0aGUgYWNjb3VudFxuICAgKiBAcHJvcGVydHkge1ZlcnNpb259IHZlcnNpb24gTVQgdmVyc2lvblxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gW3Byb3Zpc2lvbmluZ1Byb2ZpbGVJZF0gaWQgb2YgdGhlIGFjY291bnQncyBwcm92aXNpb25pbmcgcHJvZmlsZVxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gYXBwbGljYXRpb24gYXBwbGljYXRpb24gbmFtZSB0byBjb25uZWN0IHRoZSBhY2NvdW50IHRvLiBDdXJyZW50bHkgYWxsb3dlZCB2YWx1ZXMgYXJlIE1ldGFBcGlcbiAgICogYW5kIEFnaWxpdW1UcmFkZVxuICAgKiBAcHJvcGVydHkge051bWJlcn0gbWFnaWMgTWV0YVRyYWRlciBtYWdpYyB0byBwbGFjZSB0cmFkZXMgdXNpbmdcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IHN0YXRlIGFjY291bnQgZGVwbG95bWVudCBzdGF0ZS4gT25lIG9mIENSRUFURUQsIERFUExPWUlORywgREVQTE9ZRUQsIFVOREVQTE9ZSU5HLCBVTkRFUExPWUVELFxuICAgKiBERUxFVElOR1xuICAgKiBAcHJvcGVydHkge1N0cmluZ30gY29ubmVjdGlvblN0YXR1cyB0ZXJtaW5hbCAmIGJyb2tlciBjb25uZWN0aW9uIHN0YXR1cywgb25lIG9mIENPTk5FQ1RFRCwgRElTQ09OTkVDVEVELFxuICAgKiBESVNDT05ORUNURURfRlJPTV9CUk9LRVJcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IGFjY2Vzc1Rva2VuIGF1dGhvcml6YXRpb24gdG9rZW4gdG8gYmUgdXNlZCBmb3IgYWNjZXNzaW5nIHNpbmdsZSBhY2NvdW50IGRhdGEuXG4gICAqIEludGVuZGVkIHRvIGJlIHVzZWQgaW4gYnJvd3NlciBBUEkuXG4gICAqIEBwcm9wZXJ0eSB7Qm9vbGVhbn0gW21hbnVhbFRyYWRlc10gZmxhZyBpbmRpY2F0aW5nIGlmIHRyYWRlcyBzaG91bGQgYmUgcGxhY2VkIGFzIG1hbnVhbCB0cmFkZXMuIERlZmF1bHQgaXMgZmFsc2UuXG4gICAqIFN1cHBvcnRlZCBvbiBHMiBvbmx5XG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBxdW90ZVN0cmVhbWluZ0ludGVydmFsSW5TZWNvbmRzIFF1b3RlIHN0cmVhbWluZyBpbnRlcnZhbCBpbiBzZWNvbmRzLiBTZXQgdG8gMCBpbiBvcmRlciB0b1xuICAgKiByZWNlaXZlIHF1b3RlcyBvbiBlYWNoIHRpY2suIERlZmF1bHQgdmFsdWUgaXMgMi41IHNlY29uZHMuIEludGVydmFscyBsZXNzIHRoYW4gMi41IHNlY29uZHMgYXJlIHN1cHBvcnRlZFxuICAgKiBvbmx5IGZvciBHMlxuICAgKiBAcHJvcGVydHkge0FycmF5PHN0cmluZz59IFt0YWdzXSBNZXRhVHJhZGVyIGFjY291bnQgdGFnc1xuICAgKiBAcHJvcGVydHkge09iamVjdH0gW21ldGFkYXRhXSBleHRyYSBpbmZvcm1hdGlvbiB3aGljaCBjYW4gYmUgc3RvcmVkIHRvZ2V0aGVyIHdpdGggeW91ciBhY2NvdW50XG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSByZWxpYWJpbGl0eSB1c2VkIHRvIGluY3JlYXNlIHRoZSByZWxpYWJpbGl0eSBvZiB0aGUgYWNjb3VudC4gQWxsb3dlZCB2YWx1ZXMgYXJlIHJlZ3VsYXIgYW5kXG4gICAqIGhpZ2guIERlZmF1bHQgaXMgcmVndWxhclxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gW2Jhc2VDdXJyZW5jeV0gMy1jaGFyYWN0ZXIgSVNPIGN1cnJlbmN5IGNvZGUgb2YgdGhlIGFjY291bnQgYmFzZSBjdXJyZW5jeS4gRGVmYXVsdCB2YWx1ZSBpcyBVU0QuXG4gICAqIFRoZSBzZXR0aW5nIGlzIHRvIGJlIHVzZWQgZm9yIGNvcHkgdHJhZGluZyBhY2NvdW50cyB3aGljaCB1c2UgbmF0aW9uYWwgY3VycmVuY2llcyBvbmx5LCBzdWNoIGFzIHNvbWUgQnJhemlsaWFuXG4gICAqIGJyb2tlcnMuIFlvdSBzaG91bGQgbm90IGFsdGVyIHRoaXMgc2V0dGluZyB1bmxlc3MgeW91IHVuZGVyc3RhbmQgd2hhdCB5b3UgYXJlIGRvaW5nLlxuICAgKiBAcHJvcGVydHkge0FycmF5PHN0cmluZz59IFtjb3B5RmFjdG9yeVJvbGVzXSBBY2NvdW50IHJvbGVzIGZvciBDb3B5RmFjdG9yeTIgYXBwbGljYXRpb24uIEFsbG93ZWQgdmFsdWVzIGFyZVxuICAgKiBgUFJPVklERVJgIGFuZCBgU1VCU0NSSUJFUmBcbiAgICogQHByb3BlcnR5IHtOdW1iZXJ9IHJlc291cmNlU2xvdHMgTnVtYmVyIG9mIHJlc291cmNlIHNsb3RzIHRvIGFsbG9jYXRlIHRvIGFjY291bnQuIEFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2Ugc2xvdHNcbiAgICogcmVzdWx0cyBpbiBiZXR0ZXIgYWNjb3VudCBwZXJmb3JtYW5jZSB1bmRlciBsb2FkIHdoaWNoIGlzIHVzZWZ1bCBmb3Igc29tZSBhcHBsaWNhdGlvbnMuIEUuZy4gaWYgeW91IGhhdmUgbWFueVxuICAgKiBhY2NvdW50cyBjb3B5aW5nIHRoZSBzYW1lIHN0cmF0ZWd5IHZpYSBDb295RmFjdG9yeSBBUEksIHRoZW4geW91IGNhbiBpbmNyZWFzZSByZXNvdXJjZVNsb3RzIHRvIGdldCBhIGxvd2VyIHRyYWRlXG4gICAqIGNvcHlpbmcgbGF0ZW5jeS4gUGxlYXNlIG5vdGUgdGhhdCBhbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzIGlzIGEgcGFpZCBvcHRpb24uIFBsZWFzZSBub3RlIHRoYXQgaGlnaFxuICAgKiByZWxpYWJpbGl0eSBhY2NvdW50cyB1c2UgcmVkdW5kYW50IGluZnJhc3RydWN0dXJlLCBzbyB0aGF0IGVhY2ggcmVzb3VyY2Ugc2xvdCBmb3IgYSBoaWdoIHJlbGlhYmlsaXR5IGFjY291bnRcbiAgICogaXMgYmlsbGVkIGFzIDIgc3RhbmRhcmQgcmVzb3VyY2Ugc2xvdHMuICBEZWZhdWx0IGlzIDEuXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbY29weUZhY3RvcnlSZXNvdXJjZVNsb3RzXSBOdW1iZXIgb2YgQ29weUZhY3RvcnkgMiByZXNvdXJjZSBzbG90cyB0byBhbGxvY2F0ZSB0byBhY2NvdW50LlxuICAgKiBBbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzIHJlc3VsdHMgaW4gbG93ZXIgdHJhZGUgY29weWluZyBsYXRlbmN5LiBQbGVhc2Ugbm90ZSB0aGF0IGFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2VcbiAgICogc2xvdHMgaXMgYSBwYWlkIG9wdGlvbi4gUGxlYXNlIGFsc28gbm90ZSB0aGF0IENvcHlGYWN0b3J5IDIgdXNlcyByZWR1bmRhbnQgaW5mcmFzdHJ1Y3R1cmUgc28gdGhhdFxuICAgKiBlYWNoIENvcHlGYWN0b3J5IHJlc291cmNlIHNsb3QgaXMgYmlsbGVkIGFzIDIgc3RhbmRhcmQgcmVzb3VyY2Ugc2xvdHMuIFlvdSB3aWxsIGJlIGJpbGxlZCBmb3IgQ29weUZhY3RvcnkgMlxuICAgKiByZXNvdXJjZSBzbG90cyBvbmx5IGlmIHlvdSBoYXZlIGFkZGVkIHlvdXIgYWNjb3VudCB0byBDb3B5RmFjdG9yeSAyIGJ5IHNwZWNpZnlpbmcgY29weUZhY3RvcnlSb2xlcyBmaWVsZC5cbiAgICogRGVmYXVsdCBpcyAxLlxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gW3N5bWJvbF0gYW55IHN5bWJvbCBwcm92aWRlZCBieSBicm9rZXIgKHJlcXVpcmVkIGZvciBHMSBvbmx5KSBcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IHJlZ2lvbiByZWdpb24gaWQgdG8gZGVwbG95IGFjY291bnQgYXQuIE9uZSBvZiByZXR1cm5lZCBieSB0aGUgL3VzZXJzL2N1cnJlbnQvcmVnaW9ucyBlbmRwb2ludFxuICAgKiBAcHJvcGVydHkge051bWJlcn0gW3NsaXBwYWdlXSBkZWZhdWx0IHRyYWRlIHNsaXBwYWdlIGluIHBvaW50cy4gU2hvdWxkIGJlIGdyZWF0ZXIgb3IgZXF1YWwgdG8gemVyby4gSWYgbm90XG4gICAqIHNwZWNpZmllZCwgc3lzdGVtIGludGVybmFsIHNldHRpbmcgd2lsbCBiZSB1c2VkIHdoaWNoIHdlIGJlbGlldmUgaXMgcmVhc29uYWJsZSBmb3IgbW9zdCBjYXNlc1xuICAgKiBAcHJvcGVydHkge0Jvb2xlYW59IFtwcmltYXJ5UmVwbGljYV0gZmxhZyBpbmRpY2F0aW5nIHRoYXQgYWNjb3VudCBpcyBwcmltYXJ5XG4gICAqIEBwcm9wZXJ0eSB7Qm9vbGVhbn0gW3Jpc2tNYW5hZ2VtZW50QXBpRW5hYmxlZF0gZmxhZyBpbmRpY2F0aW5nIHRoYXQgcmlzayBtYW5hZ2VtZW50IEFQSSBzaG91bGQgYmUgZW5hYmxlZCBvblxuICAgKiBhY2NvdW50LiBEZWZhdWx0IGlzIGZhbHNlXG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8TWV0YXRyYWRlckFjY291bnRSZXBsaWNhRHRvPn0gW2FjY291bnRSZXBsaWNhc10gTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2FzXG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8QWNjb3VudENvbm5lY3Rpb24+fSBjb25uZWN0aW9ucyBhY3RpdmUgYWNjb3VudCBjb25uZWN0aW9uc1xuICAgKi9cblxuICAvKipcbiAgICogQWNjb3VudCBjb25uZWN0aW9uXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IEFjY291bnRDb25uZWN0aW9uXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSByZWdpb24gcmVnaW9uIHRoZSBhY2NvdW50IGlzIGNvbm5lY3RlZCBhdFxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gem9uZSBhdmFpbGFiaWxpdHkgem9uZSB0aGUgYWNjb3VudCBpcyBjb25uZWN0ZWQgYXRcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IGFwcGxpY2F0aW9uIGFwcGxpY2F0aW9uIHRoZSBhY2NvdW50IGlzIGNvbm5lY3RlZCB0bywgb25lIG9mIGBNZXRhQXBpYCwgYENvcHlGYWN0b3J5IHN1YnNjcmliZXJgLFxuICAgKiBgQ29weUZhY3RvcnkgcHJvdmlkZXJgLCBgQ29weUZhY3RvcnkgaGlzdG9yeSBpbXBvcnRgLCBgUmlzayBtYW5hZ2VtZW50YFxuICAgKi9cblxuICAvKipcbiAgICogTVQgdmVyc2lvblxuICAgKiBAdHlwZWRlZiB7NCB8IDV9IFZlcnNpb25cbiAgICovXG5cbiAgLyoqXG4gICAqIEFjY291bnQgdHlwZVxuICAgKiBAdHlwZWRlZiB7J2Nsb3VkJyB8ICdzZWxmLWhvc3RlZCd9IFR5cGVcbiAgICovXG5cbiAgLyoqXG4gICAqIEFjY291bnQgc3RhdGVcbiAgICogQHR5cGVkZWYgeydDUkVBVEVEJyB8ICdERVBMT1lJTkcnIHwgJ0RFUExPWUVEJyB8ICdERVBMT1lfRkFJTEVEJyB8ICdVTkRFUExPWUlORycgfCAnVU5ERVBMT1lFRCcgfFxuICAgKiAnVU5ERVBMT1lfRkFJTEVEJyB8ICdERUxFVElORycgfCAnREVMRVRFX0ZBSUxFRCcgfCAnUkVERVBMT1lfRkFJTEVEJ30gU3RhdGVcbiAgICovXG5cbiAgLyoqXG4gICAqIEFjY291bnQgY29ubmVjdGlvbiBzdGF0dXNcbiAgICogQHR5cGVkZWYgeydDT05ORUNURUQnIHwgJ0RJU0NPTk5FQ1RFRCcgfCAnRElTQ09OTkVDVEVEX0ZST01fQlJPS0VSJ30gQ29ubmVjdGlvblN0YXR1c1xuICAgKi9cblxuICAvKipcbiAgICogQHR5cGVkZWYge09iamVjdH0gQWNjb3VudHNGaWx0ZXJcbiAgICogQHByb3BlcnR5IHtOdW1iZXJ9IFtvZmZzZXRdIHNlYXJjaCBvZmZzZXQgKGRlZmF1bHRzIHRvIDApIChtdXN0IGJlIGdyZWF0ZXIgb3IgZXF1YWwgdG8gMClcbiAgICogQHByb3BlcnR5IHtOdW1iZXJ9IFtsaW1pdF0gc2VhcmNoIGxpbWl0IChkZWZhdWx0cyB0byAxMDAwKSBcbiAgICogKG11c3QgYmUgZ3JlYXRlciBvciBlcXVhbCB0byAxIGFuZCBsZXNzIG9yIGVxdWFsIHRvIDEwMDApXG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8VmVyc2lvbj4gfCBWZXJzaW9ufSBbdmVyc2lvbl0gTVQgdmVyc2lvblxuICAgKiBAcHJvcGVydHkge0FycmF5PFR5cGU+IHwgVHlwZX0gW3R5cGVdIGFjY291bnQgdHlwZVxuICAgKiBAcHJvcGVydHkge0FycmF5PFN0YXRlPiB8IFN0YXRlfSBbc3RhdGVdIGFjY291bnQgc3RhdGVcbiAgICogQHByb3BlcnR5IHtBcnJheTxDb25uZWN0aW9uU3RhdHVzPiB8IENvbm5lY3Rpb25TdGF0dXN9IFtjb25uZWN0aW9uU3RhdHVzXSBjb25uZWN0aW9uIHN0YXR1c1xuICAgKiBAcHJvcGVydHkge1N0cmluZ30gW3F1ZXJ5XSBzZWFyY2hlcyBvdmVyIF9pZCwgbmFtZSwgc2VydmVyIGFuZCBsb2dpbiB0byBtYXRjaCBxdWVyeVxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gW3Byb3Zpc2lvbmluZ1Byb2ZpbGVJZF0gcHJvdmlzaW9uaW5nIHByb2ZpbGUgaWRcbiAgICovXG5cbiAgLyoqXG4gICAqIFJldHJpZXZlcyBNZXRhVHJhZGVyIGFjY291bnRzIG93bmVkIGJ5IHVzZXIgKHNlZSBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2FjY291bnQvcmVhZEFjY291bnRzLylcbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtBY2NvdW50c0ZpbHRlcn0gYWNjb3VudHNGaWx0ZXIgb3B0aW9uYWwgZmlsdGVyXG4gICAqIEByZXR1cm4ge1Byb21pc2U8QXJyYXk8TWV0YXRyYWRlckFjY291bnREdG8+Pn0gcHJvbWlzZSByZXNvbHZpbmcgd2l0aCBNZXRhVHJhZGVyIGFjY291bnRzIGZvdW5kXG4gICAqL1xuICBnZXRBY2NvdW50cyhhY2NvdW50c0ZpbHRlciA9IHt9KSB7XG4gICAgaWYgKHRoaXMuX2lzTm90Snd0VG9rZW4oKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZU5vQWNjZXNzRXJyb3IoJ2dldEFjY291bnRzJyk7XG4gICAgfVxuICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICB1cmw6IGAke3RoaXMuX2hvc3R9L3VzZXJzL2N1cnJlbnQvYWNjb3VudHNgLFxuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIHFzOiBhY2NvdW50c0ZpbHRlcixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWVcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ2dldEFjY291bnRzJyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIGEgTWV0YVRyYWRlciBhY2NvdW50IGJ5IGlkIChzZWUgaHR0cHM6Ly9tZXRhYXBpLmNsb3VkL2RvY3MvcHJvdmlzaW9uaW5nL2FwaS9hY2NvdW50L3JlYWRBY2NvdW50LykuIFRocm93c1xuICAgKiBhbiBlcnJvciBpZiBhY2NvdW50IGlzIG5vdCBmb3VuZC5cbiAgICogQHBhcmFtIHtTdHJpbmd9IGlkIE1ldGFUcmFkZXIgYWNjb3VudCBpZFxuICAgKiBAcmV0dXJuIHtQcm9taXNlPE1ldGF0cmFkZXJBY2NvdW50RHRvPn0gcHJvbWlzZSByZXNvbHZpbmcgd2l0aCBNZXRhVHJhZGVyIGFjY291bnQgZm91bmRcbiAgICovXG4gIGdldEFjY291bnQoaWQpIHtcbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7aWR9YCxcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdhdXRoLXRva2VuJzogdGhpcy5fdG9rZW5cbiAgICAgIH0sXG4gICAgICBqc29uOiB0cnVlXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICdnZXRBY2NvdW50Jyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIGEgTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2EgYnkgaWQgKHNlZSBcbiAgICogaHR0cHM6Ly9tZXRhYXBpLmNsb3VkL2RvY3MvcHJvdmlzaW9uaW5nL2FwaS9hY2NvdW50UmVwbGljYS9yZWFkQWNjb3VudFJlcGxpY2EvKS5cbiAgICogVGhyb3dzIGFuIGVycm9yIGlmIGFjY291bnQgaXMgbm90IGZvdW5kLlxuICAgKiBAcGFyYW0ge1N0cmluZ30gcHJpbWFyeUFjY291bnRJZCBNZXRhVHJhZGVyIGFjY291bnQgaWRcbiAgICogQHBhcmFtIHtTdHJpbmd9IHJlcGxpY2FJZCBNZXRhVHJhZGVyIGFjY291bnQgcmVwbGljYSBpZFxuICAgKiBAcmV0dXJuIHtQcm9taXNlPE1ldGF0cmFkZXJBY2NvdW50UmVwbGljYUR0bz59IHByb21pc2UgcmVzb2x2aW5nIHdpdGggTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2EgZm91bmRcbiAgICovXG4gIGdldEFjY291bnRSZXBsaWNhKHByaW1hcnlBY2NvdW50SWQsIHJlcGxpY2FJZCkge1xuICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICB1cmw6IGAke3RoaXMuX2hvc3R9L3VzZXJzL2N1cnJlbnQvYWNjb3VudHMvJHtwcmltYXJ5QWNjb3VudElkfS9yZXBsaWNhcy8ke3JlcGxpY2FJZH1gLFxuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWVcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ2dldEFjY291bnRSZXBsaWNhJyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIGEgTWV0YVRyYWRlciBhY2NvdW50IGJ5IHRva2VuIChzZWUgaHR0cHM6Ly9tZXRhYXBpLmNsb3VkL2RvY3MvcHJvdmlzaW9uaW5nL2FwaS9hY2NvdW50L3JlYWRBY2NvdW50LykuXG4gICAqIFRocm93cyBhbiBlcnJvciBpZiBhY2NvdW50IGlzIG5vdCBmb3VuZC5cbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIGFjY291bnQgYWNjZXNzIHRva2VuXG4gICAqIEByZXR1cm4ge1Byb21pc2U8TWV0YXRyYWRlckFjY291bnREdG8+fSBwcm9taXNlIHJlc29sdmluZyB3aXRoIE1ldGFUcmFkZXIgYWNjb3VudCBmb3VuZFxuICAgKi9cbiAgZ2V0QWNjb3VudEJ5VG9rZW4oKSB7XG4gICAgaWYgKHRoaXMuX2lzTm90QWNjb3VudFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCdnZXRBY2NvdW50QnlUb2tlbicpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzL2FjY2Vzc1Rva2VuLyR7dGhpcy5fdG9rZW59YCxcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICBqc29uOiB0cnVlXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICdnZXRBY2NvdW50QnlUb2tlbicpO1xuICB9XG5cbiAgLyoqXG4gICAqIE5ldyBNZXRhVHJhZGVyIGFjY291bnQgbW9kZWxcbiAgICogQHR5cGVkZWYge09iamVjdH0gTmV3TWV0YXRyYWRlckFjY291bnREdG9cbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IG5hbWUgTWV0YVRyYWRlciBhY2NvdW50IGh1bWFuLXJlYWRhYmxlIG5hbWUgaW4gdGhlIE1ldGFBcGkgYXBwXG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBbdHlwZV0gYWNjb3VudCB0eXBlLCBjYW4gYmUgY2xvdWQsIGNsb3VkLWcxLCBjbG91ZC1nMiBvciBzZWxmLWhvc3RlZC4gY2xvdWQtZzIgYW5kIGNsb3VkIGFyZVxuICAgKiBhbGlhc2VzLiBXaGVuIHlvdSBjcmVhdGUgTVQ1IGNsb3VkIGFjY291bnQgdGhlIHR5cGUgaXMgYXV0b21hdGljYWxseSBjb252ZXJ0ZWQgdG8gY2xvdWQtZzEgYmVjYXVzZSBNVDUgRzIgc3VwcG9ydFxuICAgKiBpcyBzdGlsbCBleHBlcmltZW50YWwuIFlvdSBjYW4gc3RpbGwgY3JlYXRlIE1UNSBHMiBhY2NvdW50IGJ5IHNldHRpbmcgdHlwZSB0byBjbG91ZC1nMi5cbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IGxvZ2luIE1ldGFUcmFkZXIgYWNjb3VudCBudW1iZXJcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IHBhc3N3b3JkIE1ldGFUcmFkZXIgYWNjb3VudCBwYXNzd29yZC4gVGhlIHBhc3N3b3JkIGNhbiBiZSBlaXRoZXIgaW52ZXN0b3IgcGFzc3dvcmQgZm9yIHJlYWQtb25seVxuICAgKiBhY2Nlc3Mgb3IgbWFzdGVyIHBhc3N3b3JkIHRvIGVuYWJsZSB0cmFkaW5nIGZlYXR1cmVzLiBSZXF1aXJlZCBmb3IgY2xvdWQgYWNjb3VudFxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gc2VydmVyIE1ldGFUcmFkZXIgc2VydmVyIHdoaWNoIGhvc3RzIHRoZSBhY2NvdW50XG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBbcGxhdGZvcm1dIHBsYXRmb3JtIGlkIChtdDQgb3IgbXQ1KVxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gW3Byb3Zpc2lvbmluZ1Byb2ZpbGVJZF0gaWQgb2YgdGhlIGFjY291bnQncyBwcm92aXNpb25pbmcgcHJvZmlsZVxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gYXBwbGljYXRpb24gYXBwbGljYXRpb24gbmFtZSB0byBjb25uZWN0IHRoZSBhY2NvdW50IHRvLiBDdXJyZW50bHkgYWxsb3dlZCB2YWx1ZXMgYXJlIE1ldGFBcGkgYW5kXG4gICAqIEFnaWxpdW1UcmFkZVxuICAgKiBAcHJvcGVydHkge051bWJlcn0gbWFnaWMgTWV0YVRyYWRlciBtYWdpYyB0byBwbGFjZSB0cmFkZXMgdXNpbmcuIFdoZW4gbWFudWFsVHJhZGVzIGZpZWxkIGlzIHNldCB0byB0cnVlLFxuICAgKiBtYWdpYyB2YWx1ZSBtdXN0IGJlIDBcbiAgICogQHByb3BlcnR5IHtCb29sZWFufSBbbWFudWFsVHJhZGVzXSBmbGFnIGluZGljYXRpbmcgaWYgdHJhZGVzIHNob3VsZCBiZSBwbGFjZWQgYXMgbWFudWFsIHRyYWRlcy4gRGVmYXVsdCBpcyBmYWxzZVxuICAgKiBAcHJvcGVydHkge051bWJlcn0gW3F1b3RlU3RyZWFtaW5nSW50ZXJ2YWxJblNlY29uZHNdIFF1b3RlIHN0cmVhbWluZyBpbnRlcnZhbCBpbiBzZWNvbmRzLiBTZXQgdG8gMCBpbiBvcmRlciB0b1xuICAgKiByZWNlaXZlIHF1b3RlcyBvbiBlYWNoIHRpY2suIERlZmF1bHQgdmFsdWUgaXMgMi41IHNlY29uZHMuIEludGVydmFscyBsZXNzIHRoYW4gMi41IHNlY29uZHMgYXJlIHN1cHBvcnRlZFxuICAgKiBvbmx5IGZvciBHMlxuICAgKiBAcHJvcGVydHkge0FycmF5PHN0cmluZz59IFt0YWdzXSBNZXRhVHJhZGVyIGFjY291bnQgdGFnc1xuICAgKiBAcHJvcGVydHkge09iamVjdH0gW21ldGFkYXRhXSBleHRyYSBpbmZvcm1hdGlvbiB3aGljaCBjYW4gYmUgc3RvcmVkIHRvZ2V0aGVyIHdpdGggeW91ciBhY2NvdW50XG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBbcmVsaWFiaWxpdHldIHVzZWQgdG8gaW5jcmVhc2UgdGhlIHJlbGlhYmlsaXR5IG9mIHRoZSBhY2NvdW50LiBBbGxvd2VkIHZhbHVlcyBhcmUgcmVndWxhciBhbmQgaGlnaC5cbiAgICogRGVmYXVsdCBpcyByZWd1bGFyXG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBbYmFzZUN1cnJlbmN5XSAzLWNoYXJhY3RlciBJU08gY3VycmVuY3kgY29kZSBvZiB0aGUgYWNjb3VudCBiYXNlIGN1cnJlbmN5LiBEZWZhdWx0IHZhbHVlIGlzIFVTRC5cbiAgICogVGhlIHNldHRpbmcgaXMgdG8gYmUgdXNlZCBmb3IgY29weSB0cmFkaW5nIGFjY291bnRzIHdoaWNoIHVzZSBuYXRpb25hbCBjdXJyZW5jaWVzIG9ubHksIHN1Y2ggYXMgc29tZSBCcmF6aWxpYW5cbiAgICogYnJva2Vycy4gWW91IHNob3VsZCBub3QgYWx0ZXIgdGhpcyBzZXR0aW5nIHVubGVzcyB5b3UgdW5kZXJzdGFuZCB3aGF0IHlvdSBhcmUgZG9pbmcuXG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8c3RyaW5nPn0gW2NvcHlGYWN0b3J5Um9sZXNdIEFjY291bnQgcm9sZXMgZm9yIENvcHlGYWN0b3J5MiBhcHBsaWNhdGlvbi4gQWxsb3dlZCB2YWx1ZXMgYXJlXG4gICAqIGBQUk9WSURFUmAgYW5kIGBTVUJTQ1JJQkVSYFxuICAgKiBAcHJvcGVydHkge051bWJlcn0gW3Jlc291cmNlU2xvdHNdIE51bWJlciBvZiByZXNvdXJjZSBzbG90cyB0byBhbGxvY2F0ZSB0byBhY2NvdW50LiBBbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzXG4gICAqIHJlc3VsdHMgaW4gYmV0dGVyIGFjY291bnQgcGVyZm9ybWFuY2UgdW5kZXIgbG9hZCB3aGljaCBpcyB1c2VmdWwgZm9yIHNvbWUgYXBwbGljYXRpb25zLiBFLmcuIGlmIHlvdSBoYXZlIG1hbnlcbiAgICogYWNjb3VudHMgY29weWluZyB0aGUgc2FtZSBzdHJhdGVneSB2aWEgQ29veUZhY3RvcnkgQVBJLCB0aGVuIHlvdSBjYW4gaW5jcmVhc2UgcmVzb3VyY2VTbG90cyB0byBnZXQgYSBsb3dlciB0cmFkZVxuICAgKiBjb3B5aW5nIGxhdGVuY3kuIFBsZWFzZSBub3RlIHRoYXQgYWxsb2NhdGluZyBleHRyYSByZXNvdXJjZSBzbG90cyBpcyBhIHBhaWQgb3B0aW9uLiBEZWZhdWx0IGlzIDFcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IFtzeW1ib2xdIGFueSBNZXRhVHJhZGVyIHN5bWJvbCB5b3VyIGJyb2tlciBwcm92aWRlcyBoaXN0b3JpY2FsIG1hcmtldCBkYXRhIGZvci4gVGhpcyB2YWx1ZVxuICAgKiBzaG91bGQgYmUgc3BlY2lmaWVkIGZvciBHMSBhY2NvdW50cyBvbmx5IGFuZCBvbmx5IGluIGNhc2UgeW91ciBNVCBhY2NvdW50IGZhaWxzIHRvIGNvbm5lY3QgdG8gYnJva2VyXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbY29weUZhY3RvcnlSZXNvdXJjZVNsb3RzXSBOdW1iZXIgb2YgQ29weUZhY3RvcnkgMiByZXNvdXJjZSBzbG90cyB0byBhbGxvY2F0ZSB0byBhY2NvdW50LlxuICAgKiBBbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzIHJlc3VsdHMgaW4gbG93ZXIgdHJhZGUgY29weWluZyBsYXRlbmN5LiBQbGVhc2Ugbm90ZSB0aGF0IGFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2VcbiAgICogc2xvdHMgaXMgYSBwYWlkIG9wdGlvbi4gUGxlYXNlIGFsc28gbm90ZSB0aGF0IENvcHlGYWN0b3J5IDIgdXNlcyByZWR1bmRhbnQgaW5mcmFzdHJ1Y3R1cmUgc28gdGhhdFxuICAgKiBlYWNoIENvcHlGYWN0b3J5IHJlc291cmNlIHNsb3QgaXMgYmlsbGVkIGFzIDIgc3RhbmRhcmQgcmVzb3VyY2Ugc2xvdHMuIFlvdSB3aWxsIGJlIGJpbGxlZCBmb3IgQ29weUZhY3RvcnkgMlxuICAgKiByZXNvdXJjZSBzbG90cyBvbmx5IGlmIHlvdSBoYXZlIGFkZGVkIHlvdXIgYWNjb3VudCB0byBDb3B5RmFjdG9yeSAyIGJ5IHNwZWNpZnlpbmcgY29weUZhY3RvcnlSb2xlcyBmaWVsZC5cbiAgICogRGVmYXVsdCBpcyAxLlxuICAgKiBAcHJvcGVydHkge1N0cmluZ30gW3JlZ2lvbl0gcmVnaW9uIGlkIHRvIGRlcGxveSBhY2NvdW50IGF0LiBPbmUgb2YgcmV0dXJuZWQgYnkgdGhlIC91c2Vycy9jdXJyZW50L3JlZ2lvbnMgZW5kcG9pbnRcbiAgICogQHByb3BlcnR5IHtOdW1iZXJ9IFtzbGlwcGFnZV0gZGVmYXVsdCB0cmFkZSBzbGlwcGFnZSBpbiBwb2ludHMuIFNob3VsZCBiZSBncmVhdGVyIG9yIGVxdWFsIHRvIHplcm8uIElmIG5vdFxuICAgKiBzcGVjaWZpZWQsIHN5c3RlbSBpbnRlcm5hbCBzZXR0aW5nIHdpbGwgYmUgdXNlZCB3aGljaCB3ZSBiZWxpZXZlIGlzIHJlYXNvbmFibGUgZm9yIG1vc3QgY2FzZXNcbiAgICovXG5cbiAgLyoqXG4gICAqIE1ldGFUcmFkZXIgYWNjb3VudCBpZCBtb2RlbFxuICAgKiBAdHlwZWRlZiB7T2JqZWN0fSBNZXRhdHJhZGVyQWNjb3VudElkRHRvXG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBpZCBNZXRhVHJhZGVyIGFjY291bnQgdW5pcXVlIGlkZW50aWZpZXJcbiAgICovXG5cbiAgLyoqXG4gICAqIFN0YXJ0cyBjbG91ZCBBUEkgc2VydmVyIGZvciBhIE1ldGFUcmFkZXIgYWNjb3VudCB1c2luZyBzcGVjaWZpZWQgcHJvdmlzaW9uaW5nIHByb2ZpbGUgKHNlZVxuICAgKiBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2FjY291bnQvY3JlYXRlQWNjb3VudC8pLiBJdCB0YWtlcyBzb21lIHRpbWUgdG8gbGF1bmNoIHRoZSB0ZXJtaW5hbCBhbmRcbiAgICogY29ubmVjdCB0aGUgdGVybWluYWwgdG8gdGhlIGJyb2tlciwgeW91IGNhbiB1c2UgdGhlIGNvbm5lY3Rpb25TdGF0dXMgZmllbGQgdG8gbW9uaXRvciB0aGUgY3VycmVudCBzdGF0dXMgb2YgdGhlXG4gICAqIHRlcm1pbmFsLlxuICAgKiBNZXRob2QgaXMgYWNjZXNzaWJsZSBvbmx5IHdpdGggQVBJIGFjY2VzcyB0b2tlblxuICAgKiBAcGFyYW0ge05ld01ldGF0cmFkZXJBY2NvdW50RHRvfSBhY2NvdW50IE1ldGFUcmFkZXIgYWNjb3VudCB0byBjcmVhdGVcbiAgICogQHJldHVybiB7UHJvbWlzZTxNZXRhdHJhZGVyQWNjb3VudElkRHRvPn0gcHJvbWlzZSByZXNvbHZpbmcgd2l0aCBhbiBpZCBvZiB0aGUgTWV0YVRyYWRlciBhY2NvdW50IGNyZWF0ZWRcbiAgICovXG4gIGNyZWF0ZUFjY291bnQoYWNjb3VudCkge1xuICAgIGlmICh0aGlzLl9pc05vdEp3dFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCdjcmVhdGVBY2NvdW50Jyk7XG4gICAgfVxuICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICB1cmw6IGAke3RoaXMuX2hvc3R9L3VzZXJzL2N1cnJlbnQvYWNjb3VudHNgLFxuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdhdXRoLXRva2VuJzogdGhpcy5fdG9rZW5cbiAgICAgIH0sXG4gICAgICBqc29uOiB0cnVlLFxuICAgICAgYm9keTogYWNjb3VudFxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX2h0dHBDbGllbnQucmVxdWVzdChvcHRzLCAnY3JlYXRlQWNjb3VudCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIE5ldyBNZXRhVHJhZGVyIGFjY291bnQgcmVwbGljYSBtb2RlbFxuICAgKiBAdHlwZWRlZiB7T2JqZWN0fSBOZXdNZXRhVHJhZGVyQWNjb3VudFJlcGxpY2FEdG9cbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IFtzeW1ib2xdIGFueSBzeW1ib2wgcHJvdmlkZWQgYnkgYnJva2VyIChyZXF1aXJlZCBmb3IgRzEgb25seSkgXG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBtYWdpYyBNZXRhVHJhZGVyIG1hZ2ljIHRvIHBsYWNlIHRyYWRlcyB1c2luZ1xuICAgKiBAcHJvcGVydHkge051bWJlcn0gW3F1b3RlU3RyZWFtaW5nSW50ZXJ2YWxJblNlY29uZHNdIFF1b3RlIHN0cmVhbWluZyBpbnRlcnZhbCBpbiBzZWNvbmRzLiBTZXQgdG8gMCBpbiBvcmRlciB0b1xuICAgKiByZWNlaXZlIHF1b3RlcyBvbiBlYWNoIHRpY2suIERlZmF1bHQgdmFsdWUgaXMgMi41IHNlY29uZHMuIEludGVydmFscyBsZXNzIHRoYW4gMi41IHNlY29uZHMgYXJlIHN1cHBvcnRlZFxuICAgKiBvbmx5IGZvciBHMlxuICAgKiBAcHJvcGVydHkge0FycmF5PHN0cmluZz59IFt0YWdzXSBNZXRhVHJhZGVyIGFjY291bnQgdGFnc1xuICAgKiBAcHJvcGVydHkge09iamVjdH0gW21ldGFkYXRhXSBleHRyYSBpbmZvcm1hdGlvbiB3aGljaCBjYW4gYmUgc3RvcmVkIHRvZ2V0aGVyIHdpdGggeW91ciBhY2NvdW50XG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBbcmVsaWFiaWxpdHldIHVzZWQgdG8gaW5jcmVhc2UgdGhlIHJlbGlhYmlsaXR5IG9mIHRoZSBhY2NvdW50LiBBbGxvd2VkIHZhbHVlcyBhcmUgcmVndWxhciBhbmQgaGlnaC5cbiAgICogRGVmYXVsdCBpcyByZWd1bGFyXG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBbcmVzb3VyY2VTbG90c10gbnVtYmVyIG9mIHJlc291cmNlIHNsb3RzIHRvIGFsbG9jYXRlIHRvIGFjY291bnQuIEFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2Ugc2xvdHNcbiAgICogcmVzdWx0cyBpbiBiZXR0ZXIgYWNjb3VudCBwZXJmb3JtYW5jZSB1bmRlciBsb2FkIHdoaWNoIGlzIHVzZWZ1bCBmb3Igc29tZSBhcHBsaWNhdGlvbnMuIEUuZy4gaWYgeW91IGhhdmUgbWFueVxuICAgKiBhY2NvdW50cyBjb3B5aW5nIHRoZSBzYW1lIHN0cmF0ZWd5IHZpYSBDb295RmFjdG9yeSBBUEksIHRoZW4geW91IGNhbiBpbmNyZWFzZSByZXNvdXJjZVNsb3RzIHRvIGdldCBhIGxvd2VyIHRyYWRlXG4gICAqIGNvcHlpbmcgbGF0ZW5jeS4gUGxlYXNlIG5vdGUgdGhhdCBhbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzIGlzIGEgcGFpZCBvcHRpb24uIERlZmF1bHQgaXMgMVxuICAgKiBAcHJvcGVydHkge251bWJlcn0gW2NvcHlGYWN0b3J5UmVzb3VyY2VTbG90c10gbnVtYmVyIG9mIENvcHlGYWN0b3J5IDIgcmVzb3VyY2Ugc2xvdHMgdG8gYWxsb2NhdGUgdG8gYWNjb3VudC5cbiAgICogQWxsb2NhdGluZyBleHRyYSByZXNvdXJjZSBzbG90cyByZXN1bHRzIGluIGxvd2VyIHRyYWRlIGNvcHlpbmcgbGF0ZW5jeS4gUGxlYXNlIG5vdGUgdGhhdCBhbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlXG4gICAqIHNsb3RzIGlzIGEgcGFpZCBvcHRpb24uIFBsZWFzZSBhbHNvIG5vdGUgdGhhdCBDb3B5RmFjdG9yeSAyIHVzZXMgcmVkdW5kYW50IGluZnJhc3RydWN0dXJlIHNvIHRoYXRcbiAgICogZWFjaCBDb3B5RmFjdG9yeSByZXNvdXJjZSBzbG90IGlzIGJpbGxlZCBhcyAyIHN0YW5kYXJkIHJlc291cmNlIHNsb3RzLiBZb3Ugd2lsbCBiZSBiaWxsZWQgZm9yIENvcHlGYWN0b3J5IDJcbiAgICogcmVzb3VyY2Ugc2xvdHMgb25seSBpZiB5b3UgaGF2ZSBhZGRlZCB5b3VyIGFjY291bnQgdG8gQ29weUZhY3RvcnkgMiBieSBzcGVjaWZ5aW5nIGNvcHlGYWN0b3J5Um9sZXMgZmllbGQuXG4gICAqIERlZmF1bHQgaXMgMS5cbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IHJlZ2lvbiByZWdpb24gaWQgdG8gZGVwbG95IGFjY291bnQgYXQuIE9uZSBvZiByZXR1cm5lZCBieSB0aGUgL3VzZXJzL2N1cnJlbnQvcmVnaW9ucyBlbmRwb2ludFxuICAgKi9cblxuICAvKipcbiAgICogU3RhcnRzIGNsb3VkIEFQSSBzZXJ2ZXIgZm9yIGEgTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2EgdXNpbmcgc3BlY2lmaWVkIHByaW1hcnkgYWNjb3VudCAoc2VlXG4gICAqIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudFJlcGxpY2EvY3JlYXRlQWNjb3VudFJlcGxpY2EvKS4gSXQgdGFrZXMgc29tZSB0aW1lIHRvIGxhdW5jaCB0aGUgdGVybWluYWwgYW5kXG4gICAqIGNvbm5lY3QgdGhlIHRlcm1pbmFsIHRvIHRoZSBicm9rZXIsIHlvdSBjYW4gdXNlIHRoZSBjb25uZWN0aW9uU3RhdHVzIGZpZWxkIHRvIG1vbml0b3IgdGhlIGN1cnJlbnQgc3RhdHVzIG9mIHRoZVxuICAgKiB0ZXJtaW5hbC5cbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtTdHJpbmd9IGFjY291bnRJZCBwcmltYXJ5IE1ldGFUcmFkZXIgYWNjb3VudCBpZFxuICAgKiBAcGFyYW0ge05ld01ldGFUcmFkZXJBY2NvdW50UmVwbGljYUR0b30gcmVwbGljYSBNZXRhVHJhZGVyIGFjY291bnQgdG8gY3JlYXRlXG4gICAqIEByZXR1cm4ge1Byb21pc2U8TWV0YXRyYWRlckFjY291bnRJZER0bz59IHByb21pc2UgcmVzb2x2aW5nIHdpdGggYW4gaWQgb2YgdGhlIE1ldGFUcmFkZXIgYWNjb3VudCByZXBsaWNhIGNyZWF0ZWRcbiAgICovXG4gIGNyZWF0ZUFjY291bnRSZXBsaWNhKGFjY291bnRJZCwgcmVwbGljYSkge1xuICAgIGlmICh0aGlzLl9pc05vdEp3dFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCdjcmVhdGVBY2NvdW50UmVwbGljYScpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7YWNjb3VudElkfS9yZXBsaWNhc2AsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWUsXG4gICAgICBib2R5OiByZXBsaWNhXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICdjcmVhdGVBY2NvdW50UmVwbGljYScpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0cyBBUEkgc2VydmVyIGZvciBNZXRhVHJhZGVyIGFjY291bnQuIFRoaXMgcmVxdWVzdCB3aWxsIGJlIGlnbm9yZWQgaWYgdGhlIGFjY291bnQgaGFzIGFscmVhZHkgYmVlbiBkZXBsb3llZC5cbiAgICogKHNlZSBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2FjY291bnQvZGVwbG95QWNjb3VudC8pXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBpZCBNZXRhVHJhZGVyIGFjY291bnQgaWQgdG8gZGVwbG95XG4gICAqIEByZXR1cm4ge1Byb21pc2V9IHByb21pc2UgcmVzb2x2aW5nIHdoZW4gTWV0YVRyYWRlciBhY2NvdW50IGlzIHNjaGVkdWxlZCBmb3IgZGVwbG95bWVudFxuICAgKi9cbiAgZGVwbG95QWNjb3VudChpZCkge1xuICAgIGlmICh0aGlzLl9pc05vdEp3dFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCdkZXBsb3lBY2NvdW50Jyk7XG4gICAgfVxuICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICB1cmw6IGAke3RoaXMuX2hvc3R9L3VzZXJzL2N1cnJlbnQvYWNjb3VudHMvJHtpZH0vZGVwbG95YCxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnYXV0aC10b2tlbic6IHRoaXMuX3Rva2VuXG4gICAgICB9LFxuICAgICAganNvbjogdHJ1ZVxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX2h0dHBDbGllbnQucmVxdWVzdChvcHRzLCAnZGVwbG95QWNjb3VudCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0cyBBUEkgc2VydmVyIGZvciBNZXRhVHJhZGVyIGFjY291bnQgcmVwbGljYS4gVGhpcyByZXF1ZXN0IHdpbGwgYmUgaWdub3JlZCBpZiB0aGUgcmVwbGljYSBoYXMgYWxyZWFkeSBiZWVuIGRlcGxveWVkLlxuICAgKiAoc2VlIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudFJlcGxpY2EvZGVwbG95QWNjb3VudFJlcGxpY2EvKVxuICAgKiBAcGFyYW0ge1N0cmluZ30gcHJpbWFyeUFjY291bnRJZCBNZXRhVHJhZGVyIGFjY291bnQgaWRcbiAgICogQHBhcmFtIHtTdHJpbmd9IHJlcGxpY2FJZCBNZXRhVHJhZGVyIGFjY291bnQgcmVwbGljYSBpZCB0byBkZXBsb3lcbiAgICogQHJldHVybiB7UHJvbWlzZX0gcHJvbWlzZSByZXNvbHZpbmcgd2hlbiBNZXRhVHJhZGVyIGFjY291bnQgcmVwbGljYSBpcyBzY2hlZHVsZWQgZm9yIGRlcGxveW1lbnRcbiAgICovXG4gIGRlcGxveUFjY291bnRSZXBsaWNhKHByaW1hcnlBY2NvdW50SWQsIHJlcGxpY2FJZCkge1xuICAgIGlmICh0aGlzLl9pc05vdEp3dFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCdkZXBsb3lBY2NvdW50UmVwbGljYScpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7cHJpbWFyeUFjY291bnRJZH0vcmVwbGljYXMvJHtyZXBsaWNhSWR9L2RlcGxveWAsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWVcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ2RlcGxveUFjY291bnRSZXBsaWNhJyk7XG4gIH1cblxuICAvKipcbiAgICogU3RvcHMgQVBJIHNlcnZlciBmb3IgYSBNZXRhVHJhZGVyIGFjY291bnQuIFRlcm1pbmFsIGRhdGEgc3VjaCBhcyBkb3dubG9hZGVkIG1hcmtldCBoaXN0b3J5IGRhdGEgd2lsbCBiZSBwcmVzZXJ2ZWQuXG4gICAqIChzZWUgaHR0cHM6Ly9tZXRhYXBpLmNsb3VkL2RvY3MvcHJvdmlzaW9uaW5nL2FwaS9hY2NvdW50L3VuZGVwbG95QWNjb3VudC8pXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBpZCBNZXRhVHJhZGVyIGFjY291bnQgaWQgdG8gdW5kZXBsb3lcbiAgICogQHJldHVybiB7UHJvbWlzZX0gcHJvbWlzZSByZXNvbHZpbmcgd2hlbiBNZXRhVHJhZGVyIGFjY291bnQgaXMgc2NoZWR1bGVkIGZvciB1bmRlcGxveW1lbnRcbiAgICovXG4gIHVuZGVwbG95QWNjb3VudChpZCkge1xuICAgIGlmICh0aGlzLl9pc05vdEp3dFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCd1bmRlcGxveUFjY291bnQnKTtcbiAgICB9XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVybDogYCR7dGhpcy5faG9zdH0vdXNlcnMvY3VycmVudC9hY2NvdW50cy8ke2lkfS91bmRlcGxveWAsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWVcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ3VuZGVwbG95QWNjb3VudCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3BzIEFQSSBzZXJ2ZXIgZm9yIE1ldGFUcmFkZXIgYWNjb3VudCByZXBsaWNhLiBUZXJtaW5hbCBkYXRhIHN1Y2ggYXMgZG93bmxvYWRlZCBtYXJrZXQgaGlzdG9yeSBkYXRhIHdpbGwgYmUgcHJlc2VydmVkLlxuICAgKiAoc2VlIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudFJlcGxpY2EvdW5kZXBsb3lBY2NvdW50UmVwbGljYS8pXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBwcmltYXJ5QWNjb3VudElkIE1ldGFUcmFkZXIgYWNjb3VudCBpZFxuICAgKiBAcGFyYW0ge1N0cmluZ30gcmVwbGljYUlkIE1ldGFUcmFkZXIgYWNjb3VudCByZXBsaWNhIGlkIHRvIHVuZGVwbG95XG4gICAqIEByZXR1cm4ge1Byb21pc2V9IHByb21pc2UgcmVzb2x2aW5nIHdoZW4gTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2EgaXMgc2NoZWR1bGVkIGZvciB1bmRlcGxveW1lbnRcbiAgICovXG4gIHVuZGVwbG95QWNjb3VudFJlcGxpY2EocHJpbWFyeUFjY291bnRJZCwgcmVwbGljYUlkKSB7XG4gICAgaWYgKHRoaXMuX2lzTm90Snd0VG9rZW4oKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZU5vQWNjZXNzRXJyb3IoJ3VuZGVwbG95QWNjb3VudFJlcGxpY2EnKTtcbiAgICB9XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVybDogYCR7dGhpcy5faG9zdH0vdXNlcnMvY3VycmVudC9hY2NvdW50cy8ke3ByaW1hcnlBY2NvdW50SWR9L3JlcGxpY2FzLyR7cmVwbGljYUlkfS91bmRlcGxveWAsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWVcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ3VuZGVwbG95QWNjb3VudFJlcGxpY2EnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWRlcGxveXMgTWV0YVRyYWRlciBhY2NvdW50LiBUaGlzIGlzIGVxdWl2YWxlbnQgdG8gdW5kZXBsb3kgaW1tZWRpYXRlbHkgZm9sbG93ZWQgYnkgZGVwbG95LlxuICAgKiAoc2VlIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudC9kZXBsb3lBY2NvdW50LylcbiAgICogQHBhcmFtIHtTdHJpbmd9IGlkIE1ldGFUcmFkZXIgYWNjb3VudCBpZCB0byByZWRlcGxveVxuICAgKiBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIHJlc29sdmluZyB3aGVuIE1ldGFUcmFkZXIgYWNjb3VudCBpcyBzY2hlZHVsZWQgZm9yIHJlZGVwbG95bWVudFxuICAgKi9cbiAgcmVkZXBsb3lBY2NvdW50KGlkKSB7XG4gICAgaWYgKHRoaXMuX2lzTm90Snd0VG9rZW4oKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZU5vQWNjZXNzRXJyb3IoJ3JlZGVwbG95QWNjb3VudCcpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7aWR9L3JlZGVwbG95YCxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnYXV0aC10b2tlbic6IHRoaXMuX3Rva2VuXG4gICAgICB9LFxuICAgICAganNvbjogdHJ1ZVxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX2h0dHBDbGllbnQucmVxdWVzdChvcHRzLCAncmVkZXBsb3lBY2NvdW50Jyk7XG4gIH1cblxuICAvKipcbiAgICogUmVkZXBsb3lzIE1ldGFUcmFkZXIgYWNjb3VudC4gVGhpcyBpcyBlcXVpdmFsZW50IHRvIHVuZGVwbG95IGltbWVkaWF0ZWx5IGZvbGxvd2VkIGJ5IGRlcGxveS5cbiAgICogKHNlZSBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2FjY291bnQvcmVkZXBsb3lBY2NvdW50UmVwbGljYS8pXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBwcmltYXJ5QWNjb3VudElkIE1ldGFUcmFkZXIgYWNjb3VudCBpZFxuICAgKiBAcGFyYW0ge1N0cmluZ30gcmVwbGljYUlkIE1ldGFUcmFkZXIgYWNjb3VudCByZXBsaWNhIGlkIHRvIHJlZGVwbG95XG4gICAqIEByZXR1cm4ge1Byb21pc2V9IHByb21pc2UgcmVzb2x2aW5nIHdoZW4gTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2EgaXMgc2NoZWR1bGVkIGZvciByZWRlcGxveW1lbnRcbiAgICovXG4gIHJlZGVwbG95QWNjb3VudFJlcGxpY2EocHJpbWFyeUFjY291bnRJZCwgcmVwbGljYUlkKSB7XG4gICAgaWYgKHRoaXMuX2lzTm90Snd0VG9rZW4oKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZU5vQWNjZXNzRXJyb3IoJ3JlZGVwbG95QWNjb3VudFJlcGxpY2EnKTtcbiAgICB9XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVybDogYCR7dGhpcy5faG9zdH0vdXNlcnMvY3VycmVudC9hY2NvdW50cy8ke3ByaW1hcnlBY2NvdW50SWR9L3JlcGxpY2FzLyR7cmVwbGljYUlkfS9yZWRlcGxveWAsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWVcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ3JlZGVwbG95QWNjb3VudFJlcGxpY2EnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wcyBhbmQgZGVsZXRlcyBhbiBBUEkgc2VydmVyIGZvciBhIHNwZWNpZmllZCBNZXRhVHJhZGVyIGFjY291bnQuIFRoZSB0ZXJtaW5hbCBzdGF0ZSBzdWNoIGFzIGRvd25sb2FkZWQgbWFya2V0XG4gICAqIGRhdGEgaGlzdG9yeSB3aWxsIGJlIGRlbGV0ZWQgYXMgd2VsbCB3aGVuIHlvdSBkZWxldGUgdGhlIGFjY291bnQuIChzZWVcbiAgICogaHR0cHM6Ly9tZXRhYXBpLmNsb3VkL2RvY3MvcHJvdmlzaW9uaW5nL2FwaS9hY2NvdW50L2RlbGV0ZUFjY291bnQvKS5cbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtTdHJpbmd9IGlkIE1ldGFUcmFkZXIgYWNjb3VudCBpZFxuICAgKiBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIHJlc29sdmluZyB3aGVuIE1ldGFUcmFkZXIgYWNjb3VudCBpcyBzY2hlZHVsZWQgZm9yIGRlbGV0aW9uXG4gICAqL1xuICBkZWxldGVBY2NvdW50KGlkKSB7XG4gICAgaWYgKHRoaXMuX2lzTm90Snd0VG9rZW4oKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZU5vQWNjZXNzRXJyb3IoJ2RlbGV0ZUFjY291bnQnKTtcbiAgICB9XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVybDogYCR7dGhpcy5faG9zdH0vdXNlcnMvY3VycmVudC9hY2NvdW50cy8ke2lkfWAsXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnYXV0aC10b2tlbic6IHRoaXMuX3Rva2VuXG4gICAgICB9LFxuICAgICAganNvbjogdHJ1ZVxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX2h0dHBDbGllbnQucmVxdWVzdChvcHRzLCAnZGVsZXRlQWNjb3VudCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3BzIGFuZCBkZWxldGVzIGFuIEFQSSBzZXJ2ZXIgZm9yIGEgc3BlY2lmaWVkIE1ldGFUcmFkZXIgYWNjb3VudC4gVGhlIHRlcm1pbmFsIHN0YXRlIHN1Y2ggYXMgZG93bmxvYWRlZCBtYXJrZXRcbiAgICogZGF0YSBoaXN0b3J5IHdpbGwgYmUgZGVsZXRlZCBhcyB3ZWxsIHdoZW4geW91IGRlbGV0ZSB0aGUgYWNjb3VudC4gKHNlZVxuICAgKiBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2FjY291bnQvZGVsZXRlQWNjb3VudFJlcGxpY2EvKS5cbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtTdHJpbmd9IHByaW1hcnlBY2NvdW50SWQgTWV0YVRyYWRlciBhY2NvdW50IGlkXG4gICAqIEBwYXJhbSB7U3RyaW5nfSByZXBsaWNhSWQgTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2EgaWQgdG8gZGVsZXRlXG4gICAqIEByZXR1cm4ge1Byb21pc2V9IHByb21pc2UgcmVzb2x2aW5nIHdoZW4gTWV0YVRyYWRlciBhY2NvdW50IGlzIHNjaGVkdWxlZCBmb3IgZGVsZXRpb25cbiAgICovXG4gIGRlbGV0ZUFjY291bnRSZXBsaWNhKHByaW1hcnlBY2NvdW50SWQsIHJlcGxpY2FJZCkge1xuICAgIGlmICh0aGlzLl9pc05vdEp3dFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCdkZWxldGVBY2NvdW50UmVwbGljYScpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7cHJpbWFyeUFjY291bnRJZH0vcmVwbGljYXMvJHtyZXBsaWNhSWR9YCxcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdhdXRoLXRva2VuJzogdGhpcy5fdG9rZW5cbiAgICAgIH0sXG4gICAgICBqc29uOiB0cnVlXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICdkZWxldGVBY2NvdW50UmVwbGljYScpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZWQgTWV0YVRyYWRlciBhY2NvdW50IGRhdGFcbiAgICogQHR5cGVkZWYge09iamVjdH0gTWV0YXRyYWRlckFjY291bnRVcGRhdGVEdG9cbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IG5hbWUgTWV0YVRyYWRlciBhY2NvdW50IGh1bWFuLXJlYWRhYmxlIG5hbWUgaW4gdGhlIE1ldGFBcGkgYXBwXG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBwYXNzd29yZCBNZXRhVHJhZGVyIGFjY291bnQgcGFzc3dvcmQuIFRoZSBwYXNzd29yZCBjYW4gYmUgZWl0aGVyIGludmVzdG9yIHBhc3N3b3JkIGZvciByZWFkLW9ubHlcbiAgICogYWNjZXNzIG9yIG1hc3RlciBwYXNzd29yZCB0byBlbmFibGUgdHJhZGluZyBmZWF0dXJlcy4gUmVxdWlyZWQgZm9yIGNsb3VkIGFjY291bnRcbiAgICogQHByb3BlcnR5IHtTdHJpbmd9IHNlcnZlciBNZXRhVHJhZGVyIHNlcnZlciB3aGljaCBob3N0cyB0aGUgYWNjb3VudFxuICAgKiBAcHJvcGVydHkge051bWJlcn0gW21hZ2ljXSBNZXRhVHJhZGVyIG1hZ2ljIHRvIHBsYWNlIHRyYWRlcyB1c2luZ1xuICAgKiBAcHJvcGVydHkge0Jvb2xlYW59IFttYW51YWxUcmFkZXNdIGZsYWcgaW5kaWNhdGluZyBpZiB0cmFkZXMgc2hvdWxkIGJlIHBsYWNlZCBhcyBtYW51YWwgdHJhZGVzLiBEZWZhdWx0IGlzIGZhbHNlXG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBbcXVvdGVTdHJlYW1pbmdJbnRlcnZhbEluU2Vjb25kc10gUXVvdGUgc3RyZWFtaW5nIGludGVydmFsIGluIHNlY29uZHMuIFNldCB0byAwIGluIG9yZGVyIHRvXG4gICAqIHJlY2VpdmUgcXVvdGVzIG9uIGVhY2ggdGljay4gRGVmYXVsdCB2YWx1ZSBpcyAyLjUgc2Vjb25kcy4gSW50ZXJ2YWxzIGxlc3MgdGhhbiAyLjUgc2Vjb25kcyBhcmUgc3VwcG9ydGVkXG4gICAqIG9ubHkgZm9yIEcyXG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8c3RyaW5nPn0gW3RhZ3NdIE1ldGFUcmFkZXIgYWNjb3VudCB0YWdzXG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8RXh0ZW5zaW9uPn0gW2V4dGVuc2lvbnNdIEFQSSBleHRlbnNpb25zXG4gICAqIEBwcm9wZXJ0eSB7T2JqZWN0fSBbbWV0YWRhdGFdIGV4dHJhIGluZm9ybWF0aW9uIHdoaWNoIGNhbiBiZSBzdG9yZWQgdG9nZXRoZXIgd2l0aCB5b3VyIGFjY291bnRcbiAgICogQHByb3BlcnR5IHtBcnJheTxzdHJpbmc+fSBbY29weUZhY3RvcnlSb2xlc10gQWNjb3VudCByb2xlcyBmb3IgQ29weUZhY3RvcnkyIGFwcGxpY2F0aW9uLiBBbGxvd2VkIHZhbHVlcyBhcmVcbiAgICogYFBST1ZJREVSYCBhbmQgYFNVQlNDUklCRVJgXG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBbcmVzb3VyY2VTbG90c10gTnVtYmVyIG9mIHJlc291cmNlIHNsb3RzIHRvIGFsbG9jYXRlIHRvIGFjY291bnQuIEFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2Ugc2xvdHNcbiAgICogcmVzdWx0cyBpbiBiZXR0ZXIgYWNjb3VudCBwZXJmb3JtYW5jZSB1bmRlciBsb2FkIHdoaWNoIGlzIHVzZWZ1bCBmb3Igc29tZSBhcHBsaWNhdGlvbnMuIEUuZy4gaWYgeW91IGhhdmUgbWFueVxuICAgKiBhY2NvdW50cyBjb3B5aW5nIHRoZSBzYW1lIHN0cmF0ZWd5IHZpYSBDb295RmFjdG9yeSBBUEksIHRoZW4geW91IGNhbiBpbmNyZWFzZSByZXNvdXJjZVNsb3RzIHRvIGdldCBhIGxvd2VyIHRyYWRlXG4gICAqIGNvcHlpbmcgbGF0ZW5jeS4gUGxlYXNlIG5vdGUgdGhhdCBhbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzIGlzIGEgcGFpZCBvcHRpb24uIERlZmF1bHQgaXMgMVxuICAgKi9cblxuICAvKipcbiAgICogVXBkYXRlcyBleGlzdGluZyBtZXRhdHJhZGVyIGFjY291bnQgZGF0YSAoc2VlXG4gICAqIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudC91cGRhdGVBY2NvdW50LykuXG4gICAqIE1ldGhvZCBpcyBhY2Nlc3NpYmxlIG9ubHkgd2l0aCBBUEkgYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBpZCBNZXRhVHJhZGVyIGFjY291bnQgaWRcbiAgICogQHBhcmFtIHtNZXRhdHJhZGVyQWNjb3VudFVwZGF0ZUR0b30gYWNjb3VudCB1cGRhdGVkIE1ldGFUcmFkZXIgYWNjb3VudFxuICAgKiBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIHJlc29sdmluZyB3aGVuIE1ldGFUcmFkZXIgYWNjb3VudCBpcyB1cGRhdGVkXG4gICAqL1xuICB1cGRhdGVBY2NvdW50KGlkLCBhY2NvdW50KSB7XG4gICAgaWYgKHRoaXMuX2lzTm90Snd0VG9rZW4oKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZU5vQWNjZXNzRXJyb3IoJ3VwZGF0ZUFjY291bnQnKTtcbiAgICB9XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVybDogYCR7dGhpcy5faG9zdH0vdXNlcnMvY3VycmVudC9hY2NvdW50cy8ke2lkfWAsXG4gICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnYXV0aC10b2tlbic6IHRoaXMuX3Rva2VuXG4gICAgICB9LFxuICAgICAganNvbjogdHJ1ZSxcbiAgICAgIGJvZHk6IGFjY291bnRcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ3VwZGF0ZUFjY291bnQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVkIE1ldGFUcmFkZXIgYWNjb3VudCByZXBsaWNhIGRhdGFcbiAgICogQHR5cGVkZWYge09iamVjdH0gVXBkYXRlZE1ldGF0cmFkZXJBY2NvdW50UmVwbGljYUR0b1xuICAgKiBAcHJvcGVydHkge051bWJlcn0gW21hZ2ljXSBNZXRhVHJhZGVyIG1hZ2ljIHRvIHBsYWNlIHRyYWRlcyB1c2luZ1xuICAgKiBAcHJvcGVydHkge051bWJlcn0gW3F1b3RlU3RyZWFtaW5nSW50ZXJ2YWxJblNlY29uZHNdIFF1b3RlIHN0cmVhbWluZyBpbnRlcnZhbCBpbiBzZWNvbmRzLiBTZXQgdG8gMCBpbiBvcmRlciB0b1xuICAgKiByZWNlaXZlIHF1b3RlcyBvbiBlYWNoIHRpY2suIERlZmF1bHQgdmFsdWUgaXMgMi41IHNlY29uZHMuIEludGVydmFscyBsZXNzIHRoYW4gMi41IHNlY29uZHMgYXJlIHN1cHBvcnRlZFxuICAgKiBvbmx5IGZvciBHMlxuICAgKiBAcHJvcGVydHkge0FycmF5PHN0cmluZz59IFt0YWdzXSBNZXRhVHJhZGVyIGFjY291bnQgdGFnc1xuICAgKiBAcHJvcGVydHkge09iamVjdH0gW21ldGFkYXRhXSBleHRyYSBpbmZvcm1hdGlvbiB3aGljaCBjYW4gYmUgc3RvcmVkIHRvZ2V0aGVyIHdpdGggeW91ciBhY2NvdW50XG4gICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBbcmVzb3VyY2VTbG90c10gTnVtYmVyIG9mIHJlc291cmNlIHNsb3RzIHRvIGFsbG9jYXRlIHRvIGFjY291bnQuIEFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2Ugc2xvdHNcbiAgICogcmVzdWx0cyBpbiBiZXR0ZXIgYWNjb3VudCBwZXJmb3JtYW5jZSB1bmRlciBsb2FkIHdoaWNoIGlzIHVzZWZ1bCBmb3Igc29tZSBhcHBsaWNhdGlvbnMuIEUuZy4gaWYgeW91IGhhdmUgbWFueVxuICAgKiBhY2NvdW50cyBjb3B5aW5nIHRoZSBzYW1lIHN0cmF0ZWd5IHZpYSBDb295RmFjdG9yeSBBUEksIHRoZW4geW91IGNhbiBpbmNyZWFzZSByZXNvdXJjZVNsb3RzIHRvIGdldCBhIGxvd2VyIHRyYWRlXG4gICAqIGNvcHlpbmcgbGF0ZW5jeS4gUGxlYXNlIG5vdGUgdGhhdCBhbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzIGlzIGEgcGFpZCBvcHRpb24uIERlZmF1bHQgaXMgMVxuICAgKiBAcHJvcGVydHkge251bWJlcn0gW2NvcHlGYWN0b3J5UmVzb3VyY2VTbG90c10gbnVtYmVyIG9mIENvcHlGYWN0b3J5IDIgcmVzb3VyY2Ugc2xvdHMgdG8gYWxsb2NhdGUgdG8gYWNjb3VudC5cbiAgICogQWxsb2NhdGluZyBleHRyYSByZXNvdXJjZSBzbG90cyByZXN1bHRzIGluIGxvd2VyIHRyYWRlIGNvcHlpbmcgbGF0ZW5jeS4gUGxlYXNlIG5vdGUgdGhhdCBhbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlXG4gICAqIHNsb3RzIGlzIGEgcGFpZCBvcHRpb24uIFBsZWFzZSBhbHNvIG5vdGUgdGhhdCBDb3B5RmFjdG9yeSAyIHVzZXMgcmVkdW5kYW50IGluZnJhc3RydWN0dXJlIHNvIHRoYXRcbiAgICogZWFjaCBDb3B5RmFjdG9yeSByZXNvdXJjZSBzbG90IGlzIGJpbGxlZCBhcyAyIHN0YW5kYXJkIHJlc291cmNlIHNsb3RzLiBZb3Ugd2lsbCBiZSBiaWxsZWQgZm9yIENvcHlGYWN0b3J5IDJcbiAgICogcmVzb3VyY2Ugc2xvdHMgb25seSBpZiB5b3UgaGF2ZSBhZGRlZCB5b3VyIGFjY291bnQgdG8gQ29weUZhY3RvcnkgMiBieSBzcGVjaWZ5aW5nIGNvcHlGYWN0b3J5Um9sZXMgZmllbGQuXG4gICAqIERlZmF1bHQgaXMgMS5cbiAgICovXG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgZXhpc3RpbmcgbWV0YXRyYWRlciBhY2NvdW50IHJlcGxpY2EgZGF0YSAoc2VlXG4gICAqIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudC91cGRhdGVBY2NvdW50UmVwbGljYS8pLlxuICAgKiBNZXRob2QgaXMgYWNjZXNzaWJsZSBvbmx5IHdpdGggQVBJIGFjY2VzcyB0b2tlblxuICAgKiBAcGFyYW0ge1N0cmluZ30gcHJpbWFyeUFjY291bnRJZCBNZXRhVHJhZGVyIGFjY291bnQgaWRcbiAgICogQHBhcmFtIHtTdHJpbmd9IHJlcGxpY2FJZCBNZXRhVHJhZGVyIGFjY291bnQgcmVwbGljYSBpZFxuICAgKiBAcGFyYW0ge1VwZGF0ZWRNZXRhdHJhZGVyQWNjb3VudFJlcGxpY2FEdG99IGFjY291bnQgdXBkYXRlZCBNZXRhVHJhZGVyIGFjY291bnQgcmVwbGljYVxuICAgKiBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIHJlc29sdmluZyB3aGVuIE1ldGFUcmFkZXIgYWNjb3VudCByZXBsaWNhIGlzIHVwZGF0ZWRcbiAgICovXG4gIHVwZGF0ZUFjY291bnRSZXBsaWNhKHByaW1hcnlBY2NvdW50SWQsIHJlcGxpY2FJZCwgYWNjb3VudCkge1xuICAgIGlmICh0aGlzLl9pc05vdEp3dFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCd1cGRhdGVBY2NvdW50UmVwbGljYScpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7cHJpbWFyeUFjY291bnRJZH0vcmVwbGljYXMvJHtyZXBsaWNhSWR9YCxcbiAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdhdXRoLXRva2VuJzogdGhpcy5fdG9rZW5cbiAgICAgIH0sXG4gICAgICBqc29uOiB0cnVlLFxuICAgICAgYm9keTogYWNjb3VudFxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX2h0dHBDbGllbnQucmVxdWVzdChvcHRzLCAndXBkYXRlQWNjb3VudFJlcGxpY2EnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbmNyZWFzZXMgTWV0YVRyYWRlciBhY2NvdW50IHJlbGlhYmlsaXR5LiBUaGUgYWNjb3VudCB3aWxsIGJlIHRlbXBvcmFyeSBzdG9wcGVkIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb24uIChzZWVcbiAgICogaHR0cHM6Ly9tZXRhYXBpLmNsb3VkL2RvY3MvcHJvdmlzaW9uaW5nL2FwaS9hY2NvdW50L2luY3JlYXNlUmVsaWFiaWxpdHkvKS5cbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtTdHJpbmd9IGlkIE1ldGFUcmFkZXIgYWNjb3VudCBpZFxuICAgKiBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIHJlc29sdmluZyB3aGVuIE1ldGFUcmFkZXIgYWNjb3VudCByZWxpYWJpbGl0eSBpcyBpbmNyZWFzZWRcbiAgICovXG4gIGluY3JlYXNlUmVsaWFiaWxpdHkoaWQpIHtcbiAgICBpZiAodGhpcy5faXNOb3RKd3RUb2tlbigpKSB7XG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlTm9BY2Nlc3NFcnJvcignaW5jcmVhc2VSZWxpYWJpbGl0eScpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7aWR9L2luY3JlYXNlLXJlbGlhYmlsaXR5YCxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnYXV0aC10b2tlbic6IHRoaXMuX3Rva2VuXG4gICAgICB9LFxuICAgICAganNvbjogdHJ1ZVxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX2h0dHBDbGllbnQucmVxdWVzdChvcHRzLCAnaW5jcmVhc2VSZWxpYWJpbGl0eScpO1xuICB9XG5cbn1cbiJdfQ==